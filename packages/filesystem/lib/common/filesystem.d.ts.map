{"version":3,"sources":["common/filesystem.ts"],"names":[],"mappings":"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","file":"../../src/common/filesystem.d.ts","sourcesContent":["/********************************************************************************\r\n * Copyright (C) 2017 TypeFox and others.\r\n *\r\n * This program and the accompanying materials are made available under the\r\n * terms of the Eclipse Public License v. 2.0 which is available at\r\n * http://www.eclipse.org/legal/epl-2.0.\r\n *\r\n * This Source Code may also be made available under the following Secondary\r\n * Licenses when the conditions for such availability set forth in the Eclipse\r\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\r\n * with the GNU Classpath Exception which is available at\r\n * https://www.gnu.org/software/classpath/license.html.\r\n *\r\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\r\n ********************************************************************************/\r\n\r\n/* eslint-disable max-len */\r\n\r\nimport {TextDocumentContentChangeEvent} from 'vscode-languageserver-protocol';\r\nimport {ApplicationError} from '@tart/core/lib/common';\r\n\r\n/**\r\n * @deprecated since 1.4.0 - in order to support VS Code FS API (https://github.com/eclipse-tart/tart/pull/7908), use `FileService` instead\r\n */\r\nexport const FileSystem = Symbol('FileSystem');\r\n\r\nexport interface FileSystem {\r\n\r\n    /**\r\n     * Returns the file stat for the given URI.\r\n     *\r\n     * If the uri points to a folder it will contain one level of unresolved children.\r\n     *\r\n     * `undefined` if a file for the given URI does not exist.\r\n     *\r\n     * @deprecated since 1.4.0 - in order to support VS Code FS API (https://github.com/eclipse-tart/tart/pull/7908), use `FileService.resolve` instead\r\n     */\r\n    getFileStat(uri: string): Promise<FileStat | undefined>;\r\n\r\n    /**\r\n     * Finds out if a file identified by the resource exists.\r\n     *\r\n     * @deprecated since 1.4.0 - in order to support VS Code FS API (https://github.com/eclipse-tart/tart/pull/7908), use `FileService.exists` instead\r\n     */\r\n    exists(uri: string): Promise<boolean>;\r\n\r\n    /**\r\n     * Resolve the contents of a file identified by the resource.\r\n     *\r\n     * @deprecated since 1.4.0 - in order to support VS Code FS API (https://github.com/eclipse-tart/tart/pull/7908), use `FileService.read` instead\r\n     */\r\n    resolveContent(uri: string, options?: { encoding?: string }): Promise<{ stat: FileStat, content: string }>;\r\n\r\n    /**\r\n     * Updates the content replacing its previous value.\r\n     *\r\n     * @deprecated since 1.4.0 - in order to support VS Code FS API (https://github.com/eclipse-tart/tart/pull/7908), use `FileService.write` instead\r\n     */\r\n    setContent(file: FileStat, content: string, options?: { encoding?: string }): Promise<FileStat>;\r\n\r\n    /**\r\n     * Updates the content replacing its previous value.\r\n     *\r\n     * The optional parameter `overwriteEncoding` can be used to transform the encoding of a file.\r\n     *\r\n     * |   | encoding | overwriteEncoding | behaviour |\r\n     * |---|----------|-------------------|-----------|\r\n     * | 1 | undefined |    undefined     | read & write file in default encoding |\r\n     * | 2 | undefined |        ✓         | read file in default encoding; write file in `overwriteEncoding` |\r\n     * | 3 |     ✓    |     undefined     | read & write file in `encoding` |\r\n     * | 4 |     ✓    |        ✓         | read file in `encoding`; write file in `overwriteEncoding` |\r\n     *\r\n     * @deprecated since 1.4.0 - in order to support VS Code FS API (https://github.com/eclipse-tart/tart/pull/7908), use `FileService.write` instead\r\n     */\r\n    updateContent(file: FileStat, contentChanges: TextDocumentContentChangeEvent[], options?: { encoding?: string, overwriteEncoding?: string }): Promise<FileStat>;\r\n\r\n    /**\r\n     * Moves the file to a new path identified by the resource.\r\n     *\r\n     * The optional parameter overwrite can be set to replace an existing file at the location.\r\n     *\r\n     * |           | missing | file | empty dir |    dir    |\r\n     * |-----------|---------|------|-----------|-----------|\r\n     * | missing   |    x    |   x  |     x     |     x     |\r\n     * | file      |    ✓    |   x  |     x     |     x     |\r\n     * | empty dir |    ✓    |   x  |     x     | overwrite |\r\n     * | dir       |    ✓    |   x  | overwrite | overwrite |\r\n     *\r\n     * @deprecated since 1.4.0 - in order to support VS Code FS API (https://github.com/eclipse-tart/tart/pull/7908), use `FileService.move` instead\r\n     */\r\n    move(sourceUri: string, targetUri: string, options?: FileMoveOptions): Promise<FileStat>;\r\n\r\n    /**\r\n     * Copies the file to a path identified by the resource.\r\n     *\r\n     * The optional parameter overwrite can be set to replace an existing file at the location.\r\n     *\r\n     * @deprecated since 1.4.0 - in order to support VS Code FS API (https://github.com/eclipse-tart/tart/pull/7908), use `FileService.copy` instead\r\n     */\r\n    copy(sourceUri: string, targetUri: string, options?: { overwrite?: boolean, recursive?: boolean }): Promise<FileStat>;\r\n\r\n    /**\r\n     * Creates a new file with the given path. The returned promise\r\n     * will have the stat model object as a result.\r\n     *\r\n     * The optional parameter content can be used as value to fill into the new file.\r\n     *\r\n     * @deprecated since 1.4.0 - in order to support VS Code FS API (https://github.com/eclipse-tart/tart/pull/7908), use `FileService.create` instead\r\n     */\r\n    createFile(uri: string, options?: { content?: string, encoding?: string }): Promise<FileStat>;\r\n\r\n    /**\r\n     * Creates a new folder with the given path. The returned promise\r\n     * will have the stat model object as a result.\r\n     *\r\n     * @deprecated since 1.4.0 - in order to support VS Code FS API (https://github.com/eclipse-tart/tart/pull/7908), use `FileService.createFolder` instead\r\n     */\r\n    createFolder(uri: string): Promise<FileStat>;\r\n\r\n    /**\r\n     * Creates a new empty file if the given path does not exist and otherwise\r\n     * will set the mtime and atime of the file to the current date.\r\n     */\r\n    touchFile(uri: string): Promise<FileStat>;\r\n\r\n    /**\r\n     * Deletes the provided file. The optional moveToTrash parameter allows to\r\n     * move the file to trash.\r\n     *\r\n     * @deprecated since 1.4.0 - in order to support VS Code FS API (https://github.com/eclipse-tart/tart/pull/7908), use `FileService.delete` instead\r\n     */\r\n    delete(uri: string, options?: FileDeleteOptions): Promise<void>;\r\n\r\n    /**\r\n     * Returns the encoding of the given file resource.\r\n     *\r\n     * @deprecated since 1.4.0 - in order to support VS Code FS API (https://github.com/eclipse-tart/tart/pull/7908) use `FileService.read` without `autoGuessEncoding` option instead\r\n     */\r\n    getEncoding(uri: string): Promise<string>;\r\n\r\n    /**\r\n     * Guess encoding of a given file based on its content.\r\n     *\r\n     * @deprecated since 1.4.0 - in order to support VS Code FS API (https://github.com/eclipse-tart/tart/pull/7908), use `FileService.read` with `autoGuessEncoding` option instead\r\n     */\r\n    guessEncoding(uri: string): Promise<string | undefined>;\r\n\r\n    /**\r\n     * Return list of available roots.\r\n     */\r\n    getRoots(): Promise<FileStat[]>;\r\n\r\n    /**\r\n     * Returns a promise that resolves to a file stat representing the current user's home directory.\r\n     *\r\n     * @deprecated since 1.4.0 - in order to support VS Code FS API (https://github.com/eclipse-tart/tart/pull/7908), use `EnvVariablesServer.getHomeDirUri` instead\r\n     */\r\n    getCurrentUserHome(): Promise<FileStat | undefined>;\r\n\r\n    /**\r\n     * Resolves to an array of URIs pointing to the available drives on the filesystem.\r\n     *\r\n     * @deprecated since 1.4.0 - in order to support VS Code FS API (https://github.com/eclipse-tart/tart/pull/7908), use `EnvVariablesServer.getDrives` instead\r\n     */\r\n    getDrives(): Promise<string[]>;\r\n\r\n    /**\r\n     * Tests a user's permissions for the file or directory specified by URI.\r\n     * The mode argument is an optional integer that specifies the accessibility checks to be performed.\r\n     * Check `FileAccess.Constants` for possible values of mode.\r\n     * It is possible to create a mask consisting of the bitwise `OR` of two or more values (e.g. FileAccess.Constants.W_OK | FileAccess.Constants.R_OK).\r\n     * If `mode` is not defined, `FileAccess.Constants.F_OK` will be used instead.\r\n     *\r\n     * @deprecated since 1.4.0 - in order to support VS Code FS API (https://github.com/eclipse-tart/tart/pull/7908), use `FileService.access` instead\r\n     */\r\n    access(uri: string, mode?: number): Promise<boolean>\r\n\r\n    /**\r\n     * Returns the path of the given file URI, specific to the backend's operating system.\r\n     * If the URI is not a file URI, undefined is returned.\r\n     *\r\n     * USE WITH CAUTION: You should always prefer URIs to paths if possible, as they are\r\n     * portable and platform independent. Paths should only be used in cases you directly\r\n     * interact with the OS, e.g. when running a command on the shell.\r\n     *\r\n     * @deprecated since 1.4.0 - in order to support VS Code FS API (https://github.com/eclipse-tart/tart/pull/7908), use `FileService.fsPath` instead\r\n     */\r\n    getFsPath(uri: string): Promise<string | undefined>\r\n}\r\n\r\n/**\r\n * @deprecated since 1.4.0 - in order to support VS Code FS API (https://github.com/eclipse-tart/tart/pull/7908), use `FileService.access` instead\r\n */\r\nexport namespace FileAccess {\r\n\r\n    export namespace Constants {\r\n\r\n        /**\r\n         * Flag indicating that the file is visible to the calling process.\r\n         * This is useful for determining if a file exists, but says nothing about rwx permissions. Default if no mode is specified.\r\n         */\r\n        export const F_OK: number = 0;\r\n\r\n        /**\r\n         * Flag indicating that the file can be read by the calling process.\r\n         */\r\n        export const R_OK: number = 4;\r\n\r\n        /**\r\n         * Flag indicating that the file can be written by the calling process.\r\n         */\r\n        export const W_OK: number = 2;\r\n\r\n        /**\r\n         * Flag indicating that the file can be executed by the calling process.\r\n         * This has no effect on Windows (will behave like `FileAccess.F_OK`).\r\n         */\r\n        export const X_OK: number = 1;\r\n\r\n    }\r\n\r\n}\r\n\r\nexport interface FileMoveOptions {\r\n    overwrite?: boolean;\r\n}\r\n\r\nexport interface FileDeleteOptions {\r\n    moveToTrash?: boolean\r\n}\r\n\r\n/**\r\n * A file resource with meta information.\r\n *\r\n * @deprecated since 1.4.0 - in order to support VS Code FS API (https://github.com/eclipse-tart/tart/pull/7908), use `FileStat` from `@tart/filesystem/lib/common/files` instead\r\n */\r\nexport interface FileStat {\r\n\r\n    /**\r\n     * The URI of the file.\r\n     */\r\n    uri: string;\r\n\r\n    /**\r\n     * The last modification of this file.\r\n     */\r\n    lastModification: number;\r\n\r\n    /**\r\n     * `true` if the resource is a directory. Otherwise, `false`.\r\n     */\r\n    isDirectory: boolean;\r\n\r\n    /**\r\n     * The children of the file stat.\r\n     * If it is `undefined` and `isDirectory` is `true`, then this file stat is unresolved.\r\n     */\r\n    children?: FileStat[];\r\n\r\n    /**\r\n     * The size of the file if known.\r\n     */\r\n    size?: number;\r\n\r\n}\r\n\r\nexport namespace FileStat {\r\n    export function is(candidate: Object | undefined): candidate is FileStat {\r\n        return typeof candidate === 'object' && ('uri' in candidate) && ('lastModification' in candidate) && ('isDirectory' in candidate);\r\n    }\r\n\r\n    export function equals(one: object | undefined, other: object | undefined): boolean {\r\n        if (!one || !other || !is(one) || !is(other)) {\r\n            return false;\r\n        }\r\n        return one.uri === other.uri\r\n            && one.lastModification === other.lastModification\r\n            && one.isDirectory === other.isDirectory;\r\n    }\r\n}\r\n\r\n/**\r\n * @deprecated since 1.4.0 - in order to support VS Code FS API (https://github.com/eclipse-tart/tart/pull/7908), use `FileOperationError` instead\r\n */\r\nexport namespace FileSystemError {\r\n    export const FileNotFound = ApplicationError.declare(-33000, (uri: string, prefix?: string) => ({\r\n        message: `${prefix ? prefix + ' ' : ''}'${uri}' has not been found.`,\r\n        data: {uri}\r\n    }));\r\n    export const FileExists = ApplicationError.declare(-33001, (uri: string, prefix?: string) => ({\r\n        message: `${prefix ? prefix + ' ' : ''}'${uri}' already exists.`,\r\n        data: {uri}\r\n    }));\r\n    export const FileIsDirectory = ApplicationError.declare(-33002, (uri: string, prefix?: string) => ({\r\n        message: `${prefix ? prefix + ' ' : ''}'${uri}' is a directory.`,\r\n        data: {uri}\r\n    }));\r\n    export const FileNotDirectory = ApplicationError.declare(-33003, (uri: string, prefix?: string) => ({\r\n        message: `${prefix ? prefix + ' ' : ''}'${uri}' is not a directory.`,\r\n        data: {uri}\r\n    }));\r\n    export const FileIsOutOfSync = ApplicationError.declare(-33004, (file: FileStat, stat: FileStat) => ({\r\n        message: `'${file.uri}' is out of sync.`,\r\n        data: {file, stat}\r\n    }));\r\n}\r\n"]}