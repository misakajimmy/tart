{"version":3,"sources":["browser/workspace-commands.ts"],"names":[],"mappings":"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","file":"../../src/browser/workspace-commands.js","sourcesContent":["import {\r\n  CommonCommands,\r\n  CommonMenus,\r\n  LabelProvider,\r\n  open,\r\n  OpenerService,\r\n  OpenHandler,\r\n  SingleTextInputDialog\r\n} from '@tart/core';\r\nimport {\r\n  Command,\r\n  CommandContribution,\r\n  CommandRegistry,\r\n  Emitter,\r\n  Event,\r\n  MenuContribution,\r\n  MenuModelRegistry,\r\n  SelectionService,\r\n} from '@tart/core/lib/common';\r\nimport {nls} from '@tart/core/lib/common/nls';\r\nimport {inject, injectable, postConstruct} from 'inversify';\r\nimport {WorkspacePreferences} from './workspace-preference';\r\nimport URI from '@tart/core/lib/common/uri';\r\nimport {FileService} from '@tart/filesystem/lib/browser/file-service';\r\nimport {WorkspaceService} from './workspace-service';\r\nimport {UriAwareCommandHandler, UriCommandHandler} from '@tart/core/lib/common/uri-command-handler';\r\nimport {FileStat} from '@tart/filesystem/lib/common/files';\r\nimport {FileSystemUtils} from '@tart/filesystem/lib/browser/file-tree/filesystem-utils';\r\nimport {WorkspaceInputDialog} from './workspace-input-dialog';\r\nimport * as validFilename from 'valid-filename';\r\nimport {FileSystemCommands} from '@tart/filesystem';\r\nimport {WorkspaceDeleteHandler} from './workspace-delete-handler';\r\nimport {FileDownloadCommands} from '@tart/filesystem/lib/browser/download/file-download-command-contribution';\r\n\r\nexport namespace WorkspaceCommands {\r\n\r\n  const WORKSPACE_CATEGORY = 'Workspaces';\r\n  const FILE_CATEGORY = CommonCommands.FILE_CATEGORY;\r\n\r\n  // On Linux and Windows, both files and folders cannot be opened at the same time in electron.\r\n  // `OPEN_FILE` and `OPEN_FOLDER` must be available only on Linux and Windows in electron.\r\n  // `OPEN` must *not* be available on Windows and Linux in electron.\r\n  // VS Code does the same. See: https://github.com/eclipse-theia/theia/pull/3202#issuecomment-430585357\r\n  export const OPEN: Command & { dialogLabel: string } = {\r\n    ...Command.toDefaultLocalizedCommand({\r\n      id: 'workspace:open',\r\n      category: CommonCommands.FILE_CATEGORY,\r\n      label: 'Open...'\r\n    }),\r\n    dialogLabel: nls.localizeByDefault('Open')\r\n  };\r\n  // No `label`. Otherwise, it shows up in the `Command Palette`.\r\n  export const OPEN_FILE: Command & { dialogLabel: string } = {\r\n    id: 'workspace:openFile',\r\n    originalCategory: FILE_CATEGORY,\r\n    category: nls.localizeByDefault(CommonCommands.FILE_CATEGORY),\r\n    dialogLabel: 'Open File'\r\n  };\r\n  export const OPEN_FOLDER: Command & { dialogLabel: string } = {\r\n    id: 'workspace:openFolder',\r\n    dialogLabel: nls.localizeByDefault('Open Folder') // No `label`. Otherwise, it shows up in the `Command Palette`.\r\n  };\r\n  export const OPEN_WORKSPACE: Command & { dialogLabel: string } = {\r\n    ...Command.toDefaultLocalizedCommand({\r\n      id: 'workspace:openWorkspace',\r\n      category: CommonCommands.FILE_CATEGORY,\r\n      label: nls.localizeByDefault('Open Workspace'),\r\n    }),\r\n    dialogLabel: nls.localizeByDefault('Open Workspace')\r\n  };\r\n  export const OPEN_RECENT_WORKSPACE = Command.toLocalizedCommand({\r\n    id: 'workspace:openRecent',\r\n    category: FILE_CATEGORY,\r\n    label: 'Open Recent Workspace...'\r\n  }, 'theia/workspace/openRecentWorkspace', CommonCommands.FILE_CATEGORY_KEY);\r\n  export const CLOSE = Command.toDefaultLocalizedCommand({\r\n    id: 'workspace:close',\r\n    category: WORKSPACE_CATEGORY,\r\n    label: 'Close Workspace'\r\n  });\r\n  export const NEW_FILE = Command.toDefaultLocalizedCommand({\r\n    id: 'file.newFile',\r\n    category: FILE_CATEGORY,\r\n    label: 'New File'\r\n  });\r\n  export const NEW_PYTHON_FILE = Command.toDefaultLocalizedCommand({\r\n    id: 'file.newPythonFile',\r\n    category: FILE_CATEGORY,\r\n    label: '新建 Python 文件'\r\n  });\r\n  export const NEW_BLOCKLY_FILE = Command.toDefaultLocalizedCommand({\r\n    id: 'file.newBlocklyFile',\r\n    category: FILE_CATEGORY,\r\n    label: '新建 Blockly 文件'\r\n  });\r\n  export const NEW_FOLDER = Command.toDefaultLocalizedCommand({\r\n    id: 'file.newFolder',\r\n    category: FILE_CATEGORY,\r\n    label: 'New Folder'\r\n  });\r\n  export const FILE_OPEN_WITH = (opener: OpenHandler): Command => ({\r\n    id: `file.openWith.${opener.id}`\r\n  });\r\n  export const FILE_RENAME = Command.toDefaultLocalizedCommand({\r\n    id: 'file.rename',\r\n    category: FILE_CATEGORY,\r\n    label: 'Rename'\r\n  });\r\n  export const FILE_DELETE = Command.toDefaultLocalizedCommand({\r\n    id: 'file.delete',\r\n    category: FILE_CATEGORY,\r\n    label: 'Delete'\r\n  });\r\n  export const FILE_DUPLICATE = Command.toLocalizedCommand({\r\n    id: 'file.duplicate',\r\n    category: FILE_CATEGORY,\r\n    label: 'Duplicate'\r\n  }, 'theia/workspace/duplicate', CommonCommands.FILE_CATEGORY_KEY);\r\n  export const FILE_COMPARE = Command.toLocalizedCommand({\r\n    id: 'file.compare',\r\n    category: FILE_CATEGORY,\r\n    label: 'Compare with Each Other'\r\n  }, 'theia/workspace/compareWithEachOther', CommonCommands.FILE_CATEGORY_KEY);\r\n  export const ADD_FOLDER = Command.toDefaultLocalizedCommand({\r\n    id: 'workspace:addFolder',\r\n    category: WORKSPACE_CATEGORY,\r\n    label: 'Add Folder to Workspace...'\r\n  });\r\n  export const REMOVE_FOLDER = Command.toDefaultLocalizedCommand({\r\n    id: 'workspace:removeFolder',\r\n    category: WORKSPACE_CATEGORY,\r\n    label: 'Remove Folder from Workspace'\r\n  });\r\n  export const SAVE_WORKSPACE_AS = Command.toDefaultLocalizedCommand({\r\n    id: 'workspace:saveAs',\r\n    category: WORKSPACE_CATEGORY,\r\n    label: 'Save Workspace As...'\r\n  });\r\n  export const OPEN_WORKSPACE_FILE = Command.toDefaultLocalizedCommand({\r\n    id: 'workspace:openConfigFile',\r\n    category: WORKSPACE_CATEGORY,\r\n    label: 'Open Workspace Configuration File'\r\n  });\r\n  export const SAVE_AS = Command.toDefaultLocalizedCommand({\r\n    id: 'file.saveAs',\r\n    category: CommonCommands.FILE_CATEGORY,\r\n    label: 'Save As...',\r\n  });\r\n}\r\n\r\nexport interface DidCreateNewResourceEvent {\r\n  uri: URI\r\n  parent: URI\r\n}\r\n\r\n\r\n@injectable()\r\nexport class WorkspaceCommandContribution implements CommandContribution {\r\n\r\n  @inject(LabelProvider) protected readonly labelProvider: LabelProvider;\r\n  @inject(FileService) protected readonly fileService: FileService;\r\n  @inject(OpenerService) protected readonly openerService: OpenerService;\r\n  @inject(WorkspaceService) protected readonly workspaceService: WorkspaceService;\r\n  @inject(SelectionService) protected readonly selectionService: SelectionService;\r\n  @inject(WorkspaceDeleteHandler) protected readonly deleteHandler: WorkspaceDeleteHandler;\r\n  @inject(WorkspacePreferences) protected readonly preferences: WorkspacePreferences;\r\n  private readonly onDidCreateNewFileEmitter = new Emitter<DidCreateNewResourceEvent>();\r\n  private readonly onDidCreateNewFolderEmitter = new Emitter<DidCreateNewResourceEvent>();\r\n\r\n  get onDidCreateNewFile(): Event<DidCreateNewResourceEvent> {\r\n    return this.onDidCreateNewFileEmitter.event;\r\n  }\r\n\r\n  get onDidCreateNewFolder(): Event<DidCreateNewResourceEvent> {\r\n    return this.onDidCreateNewFolderEmitter.event;\r\n  }\r\n\r\n  @postConstruct()\r\n  init(): void {\r\n  }\r\n\r\n  registerCommands(commands: CommandRegistry) {\r\n    commands.registerCommand(WorkspaceCommands.NEW_FILE, this.newWorkspaceRootUriAwareCommandHandler({\r\n      execute: uri => this.getDirectory(uri).then(parent => {\r\n        if (parent) {\r\n          const parentUri = parent.resource;\r\n          const {fileName, fileExtension} = this.getDefaultFileConfig();\r\n          const vacantChildUri = FileSystemUtils.generateUniqueResourceURI(parentUri, parent, fileName, fileExtension);\r\n\r\n          const dialog = new WorkspaceInputDialog({\r\n            title: nls.localizeByDefault('New File'),\r\n            parentUri: parentUri,\r\n            initialValue: vacantChildUri.path.base,\r\n            validate: name => this.validateFileName(name, parent, true)\r\n          }, this.labelProvider);\r\n\r\n          dialog.open().then(async name => {\r\n            if (name) {\r\n              const fileUri = parentUri.resolve(name);\r\n              await this.fileService.create(fileUri);\r\n              this.fireCreateNewFile({parent: parentUri, uri: fileUri});\r\n              open(this.openerService, fileUri);\r\n            }\r\n          });\r\n        }\r\n      })\r\n    }));\r\n    commands.registerCommand(WorkspaceCommands.NEW_PYTHON_FILE, this.newWorkspaceRootUriAwareCommandHandler({\r\n      execute: uri => this.getDirectory(uri).then(parent => {\r\n        if (parent) {\r\n          const parentUri = parent.resource;\r\n          const {fileName} = this.getDefaultFileConfig();\r\n          const fileExtension = '.py';\r\n          const vacantChildUri = FileSystemUtils.generateUniqueResourceURI(parentUri, parent, fileName, fileExtension);\r\n\r\n          const dialog = new WorkspaceInputDialog({\r\n            title: nls.localizeByDefault('New File'),\r\n            parentUri: parentUri,\r\n            initialValue: vacantChildUri.path.base,\r\n            validate: name => this.validateFileName(name, parent, true)\r\n          }, this.labelProvider);\r\n\r\n          dialog.open().then(async name => {\r\n            if (name) {\r\n              name = name.endsWith('.py') ? name : name + '.py';\r\n              const fileUri = parentUri.resolve(name);\r\n              await this.fileService.create(fileUri);\r\n              this.fireCreateNewFile({parent: parentUri, uri: fileUri});\r\n              open(this.openerService, fileUri);\r\n            }\r\n          });\r\n        }\r\n      })\r\n    }));\r\n\r\n    commands.registerCommand(WorkspaceCommands.NEW_BLOCKLY_FILE, this.newWorkspaceRootUriAwareCommandHandler({\r\n      execute: uri => this.getDirectory(uri).then(parent => {\r\n        if (parent) {\r\n          const parentUri = parent.resource;\r\n          const {fileName} = this.getDefaultFileConfig();\r\n          const fileExtension = '.blockly';\r\n          const vacantChildUri = FileSystemUtils.generateUniqueResourceURI(parentUri, parent, fileName, fileExtension);\r\n\r\n          const dialog = new WorkspaceInputDialog({\r\n            title: nls.localizeByDefault('New File'),\r\n            parentUri: parentUri,\r\n            initialValue: vacantChildUri.path.base,\r\n            validate: name => this.validateFileName(name, parent, true)\r\n          }, this.labelProvider);\r\n\r\n          dialog.open().then(async name => {\r\n            if (name) {\r\n              name = name.endsWith('.blockly?') ? name : name + '.blockly';\r\n              const fileUri = parentUri.resolve(name);\r\n              await this.fileService.create(fileUri);\r\n              this.fireCreateNewFile({parent: parentUri, uri: fileUri});\r\n              open(this.openerService, fileUri);\r\n            }\r\n          });\r\n        }\r\n      })\r\n    }));\r\n    commands.registerCommand(WorkspaceCommands.NEW_FOLDER, this.newWorkspaceRootUriAwareCommandHandler({\r\n      execute: uri => this.getDirectory(uri).then(parent => {\r\n        if (parent) {\r\n          const parentUri = parent.resource;\r\n          const vacantChildUri = FileSystemUtils.generateUniqueResourceURI(parentUri, parent, 'Untitled');\r\n          const dialog = new WorkspaceInputDialog({\r\n            title: nls.localizeByDefault('New Folder'),\r\n            parentUri: parentUri,\r\n            initialValue: vacantChildUri.path.base,\r\n            validate: name => this.validateFileName(name, parent, true)\r\n          }, this.labelProvider);\r\n          dialog.open().then(async name => {\r\n            if (name) {\r\n              const folderUri = parentUri.resolve(name);\r\n              await this.fileService.createFolder(folderUri);\r\n              this.fireCreateNewFile({parent: parentUri, uri: folderUri});\r\n            }\r\n          });\r\n        }\r\n      })\r\n    }));\r\n    commands.registerCommand(WorkspaceCommands.FILE_RENAME, this.newMultiUriAwareCommandHandler({\r\n      isEnabled: uris => uris.some(uri => !this.isWorkspaceRoot(uri)) && uris.length === 1,\r\n      isVisible: uris => uris.some(uri => !this.isWorkspaceRoot(uri)) && uris.length === 1,\r\n      execute: (uris): void => {\r\n        uris.forEach(async uri => {\r\n          const parent = await this.getParent(uri);\r\n          if (parent) {\r\n            const oldName = uri.path.base;\r\n            const dialog = new SingleTextInputDialog({\r\n              title: nls.localizeByDefault('Rename'),\r\n              initialValue: oldName,\r\n              initialSelectionRange: {\r\n                start: 0,\r\n                end: uri.path.name.length\r\n              },\r\n              validate: async (newName, mode) => {\r\n                if (oldName === newName && mode === 'preview') {\r\n                  return false;\r\n                }\r\n                return this.validateFileRename(oldName, newName, parent);\r\n              }\r\n            });\r\n            const fileName = await dialog.open();\r\n            if (fileName) {\r\n              const oldUri = uri;\r\n              const newUri = uri.parent.resolve(fileName);\r\n              this.fileService.move(oldUri, newUri);\r\n            }\r\n          }\r\n        });\r\n      }\r\n    }));\r\n    commands.registerCommand(WorkspaceCommands.FILE_DELETE, this.newMultiUriAwareCommandHandler(this.deleteHandler));\r\n    this.preferences.ready.then(() => {\r\n      // commands.registerCommand(WorkspaceCommands.ADD_FOLDER, {\r\n      //     execute: async () => {\r\n      //         let uri = [new URI()];\r\n      //         await this.addFolderToWorkspace(...uri);\r\n      //     }\r\n      // });\r\n    });\r\n  }\r\n\r\n  protected fireCreateNewFile(uri: DidCreateNewResourceEvent): void {\r\n    this.onDidCreateNewFileEmitter.fire(uri);\r\n  }\r\n\r\n  protected fireCreateNewFolder(uri: DidCreateNewResourceEvent): void {\r\n    this.onDidCreateNewFolderEmitter.fire(uri);\r\n  }\r\n\r\n  protected async getDirectory(candidate: URI): Promise<FileStat | undefined> {\r\n    let stat: FileStat | undefined;\r\n    try {\r\n      stat = await this.fileService.resolve(candidate);\r\n    } catch {\r\n    }\r\n    if (stat && stat.isDirectory) {\r\n      return stat;\r\n    }\r\n    return this.getParent(candidate);\r\n  }\r\n\r\n  protected async validateFileRename(oldName: string, newName: string, parent: FileStat): Promise<string> {\r\n    if (\r\n        await parent.resource.resolve(newName).isEqual(parent.resource.resolve(oldName), false)\r\n    ) {\r\n      return '';\r\n    }\r\n    return this.validateFileName(newName, parent, false);\r\n  }\r\n\r\n  protected isWorkspaceRoot(uri: URI): boolean {\r\n    const rootUris = new Set(this.workspaceService.tryGetRoots().map(root => root.resource.toString()));\r\n    return rootUris.has(uri.toString());\r\n  }\r\n\r\n  protected async getParent(candidate: URI): Promise<FileStat | undefined> {\r\n    try {\r\n      return await this.fileService.resolve(candidate.parent);\r\n    } catch {\r\n      return undefined;\r\n    }\r\n  }\r\n\r\n  protected getDefaultFileConfig(): { fileName: string, fileExtension: string } {\r\n    return {\r\n      fileName: 'Untitled',\r\n      fileExtension: '.txt'\r\n    };\r\n  }\r\n\r\n  protected async addFolderToWorkspace(...uris: URI[]): Promise<void> {\r\n    if (uris.length) {\r\n      const foldersToAdd = [];\r\n      try {\r\n        for (const uri of uris) {\r\n          const stat = await this.fileService.resolve(uri);\r\n          if (stat.isDirectory) {\r\n            foldersToAdd.push(uri);\r\n          }\r\n        }\r\n        await this.workspaceService.addRoot(foldersToAdd);\r\n      } catch {\r\n      }\r\n    }\r\n  }\r\n\r\n  protected newMultiUriAwareCommandHandler(handler: UriCommandHandler<URI[]>): UriAwareCommandHandler<URI[]> {\r\n    return UriAwareCommandHandler.MultiSelect(this.selectionService, handler);\r\n  }\r\n\r\n  /**\r\n   * Returns an error message if the file name is invalid. Otherwise, an empty string.\r\n   *\r\n   * @param name the simple file name of the file to validate.\r\n   * @param parent the parent directory's file stat.\r\n   * @param allowNested allow file or folder creation using recursive path\r\n   */\r\n  protected async validateFileName(name: string, parent: FileStat, allowNested: boolean = false): Promise<string> {\r\n    if (!name) {\r\n      return '';\r\n    }\r\n    // do not allow recursive rename\r\n    if (!allowNested && !validFilename(name)) {\r\n      return nls.localizeByDefault('Invalid file or folder name');\r\n    }\r\n    if (name.startsWith('/')) {\r\n      return nls.localizeByDefault('Absolute paths or names that starts with / are not allowed');\r\n    } else if (name.startsWith(' ') || name.endsWith(' ')) {\r\n      return nls.localizeByDefault('Names with leading or trailing whitespaces are not allowed');\r\n    }\r\n    // check and validate each sub-paths\r\n    if (name.split(/[\\\\/]/).some(file => !file || !validFilename(file) || /^\\s+$/.test(file))) {\r\n      return nls.localizeByDefault('The name \"{0}\" is not a valid file or folder name.', this.trimFileName(name));\r\n    }\r\n    const childUri = parent.resource.resolve(name);\r\n    const exists = await this.fileService.exists(childUri);\r\n    if (exists) {\r\n      return nls.localizeByDefault('A file or folder \"{0}\" already exists at this location.', this.trimFileName(name));\r\n    }\r\n    return '';\r\n  }\r\n\r\n  protected trimFileName(name: string): string {\r\n    if (name && name.length > 30) {\r\n      return `${name.substr(0, 30)}...`;\r\n    }\r\n    return name;\r\n  }\r\n\r\n  protected newWorkspaceRootUriAwareCommandHandler(handler: UriCommandHandler<URI>): WorkspaceRootUriAwareCommandHandler {\r\n    return new WorkspaceRootUriAwareCommandHandler(this.workspaceService, this.selectionService, handler);\r\n  }\r\n}\r\n\r\nexport class WorkspaceRootUriAwareCommandHandler extends UriAwareCommandHandler<URI> {\r\n\r\n  constructor(\r\n      protected readonly workspaceService: WorkspaceService,\r\n      protected readonly selectionService: SelectionService,\r\n      protected readonly handler: UriCommandHandler<URI>\r\n  ) {\r\n    super(selectionService, handler);\r\n  }\r\n\r\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n  public isEnabled(...args: any[]): boolean {\r\n    return super.isEnabled(...args) && !!this.workspaceService.tryGetRoots().length;\r\n  }\r\n\r\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n  public isVisible(...args: any[]): boolean {\r\n    return super.isVisible(...args) && !!this.workspaceService.tryGetRoots().length;\r\n  }\r\n\r\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n  protected getUri(...args: any[]): URI | undefined {\r\n    const uri = super.getUri(...args);\r\n    // Return the `uri` immediately if the resource exists in any of the workspace roots and is of `file` scheme.\r\n    if (uri && uri.scheme === 'file' && this.workspaceService.getWorkspaceRootUri(uri)) {\r\n      return uri;\r\n    }\r\n    // Return the first root if available.\r\n    if (!!this.workspaceService.tryGetRoots().length) {\r\n      return this.workspaceService.tryGetRoots()[0].resource;\r\n    }\r\n  }\r\n\r\n}\r\n\r\n@injectable()\r\nexport class FileMenuContribution implements MenuContribution {\r\n\r\n  registerMenus(registry: MenuModelRegistry): void {\r\n    registry.registerMenuAction(CommonMenus.FILE_NEW, {\r\n      commandId: WorkspaceCommands.NEW_FILE.id,\r\n      order: 'a'\r\n    });\r\n    registry.registerMenuAction(CommonMenus.FILE_NEW, {\r\n      commandId: WorkspaceCommands.NEW_FOLDER.id,\r\n      order: 'b'\r\n    });\r\n    const downloadUploadMenu = [...CommonMenus.FILE, '4_downloadupload'];\r\n    registry.registerMenuAction(downloadUploadMenu, {\r\n      commandId: FileSystemCommands.UPLOAD.id,\r\n      order: 'a'\r\n    });\r\n    registry.registerMenuAction(downloadUploadMenu, {\r\n      commandId: FileDownloadCommands.DOWNLOAD.id,\r\n      order: 'b'\r\n    });\r\n  }\r\n\r\n}\r\n"]}