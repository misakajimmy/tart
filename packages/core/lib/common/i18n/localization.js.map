{"version":3,"sources":["common/i18n/localization.ts"],"names":[],"mappings":"AAAA;;;;;;;;;;;;;;kFAckF;AAElF,MAAM,CAAC,MAAM,gBAAgB,GAAG,gBAAgB,CAAC;AAEjD,MAAM,CAAC,MAAM,yBAAyB,GAAG,MAAM,CAAC,2BAA2B,CAAC,CAAC;AAsB7E,MAAM,KAAW,YAAY,CAkD5B;AAlDD,WAAiB,YAAY;IAE3B,SAAgB,MAAM,CAAC,OAAe,EAAE,IAAkB;QACxD,IAAI,MAAM,GAAG,OAAO,CAAC;QACrB,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE;YACnB,MAAM,GAAG,OAAO,CAAC,OAAO,CAAC,YAAY,EAAE,CAAC,KAAK,EAAE,IAAI,EAAE,EAAE;gBACrD,MAAM,KAAK,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;gBACtB,MAAM,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC;gBACxB,IAAI,WAAW,GAAG,KAAK,CAAC;gBACxB,IAAI,OAAO,GAAG,KAAK,QAAQ,EAAE;oBAC3B,WAAW,GAAG,GAAG,CAAC;iBACnB;qBAAM,IAAI,OAAO,GAAG,KAAK,QAAQ,IAAI,OAAO,GAAG,KAAK,SAAS,IAAI,CAAC,GAAG,EAAE;oBACtE,WAAW,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC;iBAC3B;gBACD,OAAO,WAAW,CAAC;YACrB,CAAC,CAAC,CAAC;SACJ;QACD,OAAO,MAAM,CAAC;IAChB,CAAC;IAhBe,mBAAM,SAgBrB,CAAA;IAED,SAAgB,QAAQ,CAAC,YAAsC,EAAE,GAAW,EAAE,YAAoB,EAAE,GAAG,IAAkB;QACvH,IAAI,KAAK,GAAG,YAAY,CAAC;QACzB,IAAI,YAAY,EAAE;YAChB,MAAM,WAAW,GAAG,YAAY,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC;YACnD,IAAI,WAAW,EAAE;gBACf,KAAK,GAAG,SAAS,CAAC,WAAW,CAAC,CAAC;aAChC;SACF;QACD,OAAO,MAAM,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;IAC7B,CAAC;IATe,qBAAQ,WASvB,CAAA;IAED;;;;;;OAMG;IACH,SAAgB,SAAS,CAAC,KAAa;QACrC,OAAO,KAAK,CAAC,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC;IAClC,CAAC;IAFe,sBAAS,YAExB,CAAA;IAED,SAAgB,YAAY,CAAC,GAAW;QACtC,IAAI,MAAM,GAAG,GAAG,CAAC;QACjB,MAAM,aAAa,GAAG,GAAG,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC;QAC3C,IAAI,aAAa,IAAI,CAAC,EAAE;YACtB,MAAM,GAAG,GAAG,CAAC,SAAS,CAAC,aAAa,GAAG,CAAC,CAAC,CAAC;SAC3C;QACD,OAAO,MAAM,CAAC;IAChB,CAAC;IAPe,yBAAY,eAO3B,CAAA;AACH,CAAC,EAlDgB,YAAY,KAAZ,YAAY,QAkD5B","file":"../../../src/common/i18n/localization.js","sourcesContent":["/********************************************************************************\n * Copyright (C) 2021 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nexport const localizationPath = '/services/i18n';\n\nexport const AsyncLocalizationProvider = Symbol('AsyncLocalizationProvider');\n\nexport interface AsyncLocalizationProvider {\n  getCurrentLanguage(): Promise<string>\n\n  setCurrentLanguage(languageId: string): Promise<void>\n\n  getAvailableLanguages(): Promise<string[]>\n\n  loadLocalization(languageId: string): Promise<Localization>\n}\n\nexport interface Localization {\n  languageId: string;\n  languageName?: string;\n  languagePack?: boolean;\n  localizedLanguageName?: string;\n  translations: { [key: string]: string };\n}\n\nexport type FormatType = string | number | boolean | undefined;\n\nexport namespace Localization {\n\n  export function format(message: string, args: FormatType[]): string {\n    let result = message;\n    if (args.length > 0) {\n      result = message.replace(/\\{(\\d+)\\}/g, (match, rest) => {\n        const index = rest[0];\n        const arg = args[index];\n        let replacement = match;\n        if (typeof arg === 'string') {\n          replacement = arg;\n        } else if (typeof arg === 'number' || typeof arg === 'boolean' || !arg) {\n          replacement = String(arg);\n        }\n        return replacement;\n      });\n    }\n    return result;\n  }\n\n  export function localize(localization: Localization | undefined, key: string, defaultValue: string, ...args: FormatType[]): string {\n    let value = defaultValue;\n    if (localization) {\n      const translation = localization.translations[key];\n      if (translation) {\n        value = normalize(translation);\n      }\n    }\n    return format(value, args);\n  }\n\n  /**\n   * This function normalizes values from VSCode's localizations, which often contain additional mnemonics (`&&`).\n   * The normalization removes the mnemonics from the input string.\n   *\n   * @param value Localization value coming from VSCode\n   * @returns A normalized localized value\n   */\n  export function normalize(value: string): string {\n    return value.replace(/&&/g, '');\n  }\n\n  export function transformKey(key: string): string {\n    let nlsKey = key;\n    const keySlashIndex = key.lastIndexOf('/');\n    if (keySlashIndex >= 0) {\n      nlsKey = key.substring(keySlashIndex + 1);\n    }\n    return nlsKey;\n  }\n}\n"]}