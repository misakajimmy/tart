{"version":3,"sources":["browser/tree/search-box-debounce.ts"],"names":[],"mappings":"AAAA;;;;;;;;;;;;;;kFAckF;AAElF,OAAO,EAAC,QAAQ,EAAC,MAAM,QAAQ,CAAC;AAChC,OAAO,EAAC,OAAO,EAAQ,MAAM,cAAc,CAAC;AAC5C,OAAO,EAAa,oBAAoB,EAAC,MAAM,yBAAyB,CAAC;AAczE,MAAM,KAAW,wBAAwB,CASxC;AATD,WAAiB,wBAAwB;IAEvC;;OAEG;IACU,gCAAO,GAA6B;QAC/C,KAAK,EAAE,GAAG;KACX,CAAC;AAEJ,CAAC,EATgB,wBAAwB,KAAxB,wBAAwB,QASxC;AAED;;GAEG;AACH,MAAM,OAAO,iBAAiB;IAQG;IANZ,WAAW,GAAG,IAAI,oBAAoB,EAAE,CAAC;IACzC,OAAO,GAAG,IAAI,OAAO,EAAsB,CAAC;IAC5C,OAAO,CAAa;IAE7B,KAAK,CAAqB;IAEpC,YAA+B,OAAiC;QAAjC,YAAO,GAAP,OAAO,CAA0B;QAC9D,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QACpC,IAAI,CAAC,OAAO,GAAG,QAAQ,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAC7F,CAAC;IAED,IAAI,SAAS;QACX,OAAO,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC;IAC5B,CAAC;IAED,MAAM,CAAC,KAAyB;QAC9B,IAAI,KAAK,KAAK,SAAS,EAAE;YACvB,IAAI,CAAC,KAAK,EAAE,CAAC;YACb,OAAO,SAAS,CAAC;SAClB;QACD,IAAI,IAAI,CAAC,KAAK,KAAK,SAAS,EAAE;YAC5B,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;SACpB;aAAM;YACL,IAAI,KAAK,KAAK,IAAI,EAAE;gBAClB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,KAAK,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,EAAE,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;aACzF;iBAAM;gBACL,IAAI,CAAC,KAAK,IAAI,KAAK,CAAC;aACrB;SACF;QACD,IAAI,CAAC,OAAO,EAAE,CAAC;QACf,OAAO,IAAI,CAAC,KAAK,CAAC;IACpB,CAAC;IAED,OAAO;QACL,IAAI,CAAC,WAAW,CAAC,OAAO,EAAE,CAAC;IAC7B,CAAC;IAES,WAAW,CAAC,KAAyB;QAC7C,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;IAC3B,CAAC;IAES,KAAK;QACb,IAAI,CAAC,KAAK,GAAG,SAAS,CAAC;QACvB,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;IAC9B,CAAC;CAEF","file":"../../../src/browser/tree/search-box-debounce.js","sourcesContent":["/********************************************************************************\n * Copyright (C) 2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport {debounce} from 'lodash';\nimport {Emitter, Event} from '../../common';\nimport {Disposable, DisposableCollection} from '../../common/disposable';\n\n/**\n * Options for the search term debounce.\n */\nexport interface SearchBoxDebounceOptions {\n\n  /**\n   * The delay (in milliseconds) before the debounce notifies clients about its content change.\n   */\n  readonly delay: number;\n\n}\n\nexport namespace SearchBoxDebounceOptions {\n\n  /**\n   * The default debounce option.\n   */\n  export const DEFAULT: SearchBoxDebounceOptions = {\n    delay: 200\n  };\n\n}\n\n/**\n * It notifies the clients, once if the underlying search term has changed after a given amount of delay.\n */\nexport class SearchBoxDebounce implements Disposable {\n\n  protected readonly disposables = new DisposableCollection();\n  protected readonly emitter = new Emitter<string | undefined>();\n  protected readonly handler: () => void;\n\n  protected state: string | undefined;\n\n  constructor(protected readonly options: SearchBoxDebounceOptions) {\n    this.disposables.push(this.emitter);\n    this.handler = debounce(() => this.fireChanged(this.state), this.options.delay).bind(this);\n  }\n\n  get onChanged(): Event<string | undefined> {\n    return this.emitter.event;\n  }\n\n  append(input: string | undefined): string | undefined {\n    if (input === undefined) {\n      this.reset();\n      return undefined;\n    }\n    if (this.state === undefined) {\n      this.state = input;\n    } else {\n      if (input === '\\b') {\n        this.state = this.state.length === 1 ? '' : this.state.substr(0, this.state.length - 1);\n      } else {\n        this.state += input;\n      }\n    }\n    this.handler();\n    return this.state;\n  }\n\n  dispose(): void {\n    this.disposables.dispose();\n  }\n\n  protected fireChanged(value: string | undefined): void {\n    this.emitter.fire(value);\n  }\n\n  protected reset(): void {\n    this.state = undefined;\n    this.fireChanged(undefined);\n  }\n\n}\n"]}