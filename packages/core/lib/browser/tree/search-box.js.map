{"version":3,"sources":["browser/tree/search-box.ts"],"names":[],"mappings":"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","file":"../../../src/browser/tree/search-box.js","sourcesContent":["/********************************************************************************\n * Copyright (C) 2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport {SearchBoxDebounce, SearchBoxDebounceOptions} from './search-box-debounce';\nimport {BaseWidget, Message} from '../widgets/widget';\nimport {Emitter, Event} from '../../common';\nimport {Key, KeyCode} from '../keyboard/keys';\n\n/**\n * Initializer properties for the search box widget.\n */\nexport interface SearchBoxProps extends SearchBoxDebounceOptions {\n\n  /**\n   * If `true`, the `Previous`, `Next`, and `Close` buttons will be visible. Otherwise, `false`. Defaults to `false`.\n   */\n  readonly showButtons?: boolean;\n\n  /**\n   * If `true`, `Filter` and `Close` buttons will be visible, and clicking the `Filter` button will triggers filter on the search term. Defaults to `false`.\n   */\n  readonly showFilter?: boolean;\n\n}\n\nexport namespace SearchBoxProps {\n\n  /**\n   * The default search box widget option.\n   */\n  export const DEFAULT: SearchBoxProps = SearchBoxDebounceOptions.DEFAULT;\n\n}\n\n/**\n * The search box widget.\n */\nexport class SearchBox extends BaseWidget {\n\n  protected static SPECIAL_KEYS = [\n    Key.ESCAPE,\n    Key.BACKSPACE\n  ];\n\n  protected static MAX_CONTENT_LENGTH = 15;\n\n  protected readonly nextEmitter = new Emitter<void>();\n  protected readonly previousEmitter = new Emitter<void>();\n  protected readonly closeEmitter = new Emitter<void>();\n  protected readonly textChangeEmitter = new Emitter<string | undefined>();\n  protected readonly filterToggleEmitter = new Emitter<boolean>();\n  protected readonly input: HTMLSpanElement;\n  protected readonly filter: HTMLElement | undefined;\n\n  constructor(protected readonly props: SearchBoxProps,\n              protected readonly debounce: SearchBoxDebounce) {\n\n    super();\n    this.toDispose.pushAll([\n      this.nextEmitter,\n      this.previousEmitter,\n      this.closeEmitter,\n      this.textChangeEmitter,\n      this.filterToggleEmitter,\n      this.debounce,\n      this.debounce.onChanged(data => this.fireTextChange(data))\n    ]);\n    this.hide();\n    this.update();\n    const {input, filter} = this.createContent();\n    this.input = input;\n    this.filter = filter;\n  }\n\n  protected _isFiltering: boolean = false;\n\n  get isFiltering(): boolean {\n    return this._isFiltering;\n  }\n\n  get onPrevious(): Event<void> {\n    return this.previousEmitter.event;\n  }\n\n  get onNext(): Event<void> {\n    return this.nextEmitter.event;\n  }\n\n  get onClose(): Event<void> {\n    return this.closeEmitter.event;\n  }\n\n  get onTextChange(): Event<string | undefined> {\n    return this.textChangeEmitter.event;\n  }\n\n  get onFilterToggled(): Event<boolean> {\n    return this.filterToggleEmitter.event;\n  }\n\n  get keyCodePredicate(): KeyCode.Predicate {\n    return this.canHandle.bind(this);\n  }\n\n  handle(event: KeyboardEvent): void {\n    event.preventDefault();\n    const keyCode = KeyCode.createKeyCode(event);\n    if (this.canHandle(keyCode)) {\n      if (Key.equals(Key.ESCAPE, keyCode) || this.isCtrlBackspace(keyCode)) {\n        this.hide();\n      } else {\n        this.show();\n        this.handleKey(keyCode);\n      }\n    }\n  }\n\n  onBeforeHide(): void {\n    this.removeClass(SearchBox.Styles.NO_MATCH);\n    this.doFireFilterToggle(false);\n    this.debounce.append(undefined);\n    this.fireClose();\n  }\n\n  updateHighlightInfo(info: SearchBox.HighlightInfo): void {\n    if (info.filterText && info.filterText.length > 0) {\n      if (info.matched === 0) {\n        this.addClass(SearchBox.Styles.NO_MATCH);\n      } else {\n        this.removeClass(SearchBox.Styles.NO_MATCH);\n      }\n    }\n  }\n\n  protected firePrevious(): void {\n    this.previousEmitter.fire(undefined);\n  }\n\n  protected fireNext(): void {\n    this.nextEmitter.fire(undefined);\n  }\n\n  protected fireClose(): void {\n    this.closeEmitter.fire(undefined);\n  }\n\n  protected fireTextChange(input: string | undefined): void {\n    this.textChangeEmitter.fire(input);\n  }\n\n  protected fireFilterToggle(): void {\n    this.doFireFilterToggle();\n  }\n\n  protected doFireFilterToggle(toggleTo: boolean = !this._isFiltering): void {\n    if (this.filter) {\n      if (toggleTo) {\n        this.filter.classList.add(SearchBox.Styles.FILTER_ON);\n      } else {\n        this.filter.classList.remove(SearchBox.Styles.FILTER_ON);\n      }\n      this._isFiltering = toggleTo;\n      this.filterToggleEmitter.fire(toggleTo);\n      this.update();\n    }\n  }\n\n  protected handleArrowUp(): void {\n    this.firePrevious();\n  }\n\n  protected handleArrowDown(): void {\n    this.fireNext();\n  }\n\n  protected handleKey(keyCode: KeyCode): void {\n    const character = Key.equals(Key.BACKSPACE, keyCode) ? '\\b' : keyCode.character;\n    const data = this.debounce.append(character);\n    if (data) {\n      this.input.textContent = this.getTrimmedContent(data);\n      this.update();\n    } else {\n      this.hide();\n    }\n  }\n\n  protected getTrimmedContent(data: string): string {\n    if (data.length > SearchBox.MAX_CONTENT_LENGTH) {\n      return '...' + data.substring(data.length - SearchBox.MAX_CONTENT_LENGTH);\n    }\n    return data;\n  }\n\n  protected canHandle(keyCode: KeyCode | undefined): boolean {\n    if (keyCode === undefined) {\n      return false;\n    }\n    const {ctrl, alt, meta} = keyCode;\n    if (this.isCtrlBackspace(keyCode)) {\n      return true;\n    }\n    if (ctrl || alt || meta || keyCode.key === Key.SPACE) {\n      return false;\n    }\n    if (keyCode.character || (this.isVisible && SearchBox.SPECIAL_KEYS.some(key => Key.equals(key, keyCode)))) {\n      return true;\n    }\n    return false;\n  }\n\n  protected isCtrlBackspace(keyCode: KeyCode): boolean {\n    if (keyCode.ctrl && Key.equals(Key.BACKSPACE, keyCode)) {\n      return true;\n    }\n    return false;\n  }\n\n  protected createContent(): {\n    container: HTMLElement,\n    input: HTMLSpanElement,\n    filter: HTMLElement | undefined,\n    previous: HTMLElement | undefined,\n    next: HTMLElement | undefined,\n    close: HTMLElement | undefined\n  } {\n    this.node.setAttribute('tabIndex', '0');\n    this.addClass(SearchBox.Styles.SEARCH_BOX);\n\n    const input = document.createElement('span');\n    input.classList.add(SearchBox.Styles.SEARCH_INPUT);\n    this.node.appendChild(input);\n\n    const buttons = document.createElement('div');\n    buttons.classList.add(SearchBox.Styles.SEARCH_BUTTONS_WRAPPER);\n    this.node.appendChild(buttons);\n\n    let filter: HTMLElement | undefined;\n    if (this.props.showFilter) {\n      filter = document.createElement('div');\n      filter.classList.add(\n          SearchBox.Styles.BUTTON,\n          ...SearchBox.Styles.FILTER,\n      );\n      filter.title = 'Enable Filter on Type';\n      buttons.appendChild(filter);\n      filter.onclick = this.fireFilterToggle.bind(this);\n    }\n\n    let previous: HTMLElement | undefined;\n    let next: HTMLElement | undefined;\n    let close: HTMLElement | undefined;\n\n    if (!!this.props.showButtons) {\n      previous = document.createElement('div');\n      previous.classList.add(\n          SearchBox.Styles.BUTTON,\n          SearchBox.Styles.BUTTON_PREVIOUS\n      );\n      previous.title = 'Previous (Up)';\n      buttons.appendChild(previous);\n      previous.onclick = () => this.firePrevious.bind(this)();\n\n      next = document.createElement('div');\n      next.classList.add(\n          SearchBox.Styles.BUTTON,\n          SearchBox.Styles.BUTTON_NEXT\n      );\n      next.title = 'Next (Down)';\n      buttons.appendChild(next);\n      next.onclick = () => this.fireNext.bind(this)();\n    }\n\n    if (this.props.showButtons || this.props.showFilter) {\n      close = document.createElement('div');\n      close.classList.add(\n          SearchBox.Styles.BUTTON,\n          SearchBox.Styles.BUTTON_CLOSE\n      );\n      close.title = 'Close (Escape)';\n      buttons.appendChild(close);\n      close.onclick = () => this.hide.bind(this)();\n    }\n\n    return {\n      container: this.node,\n      input,\n      filter,\n      previous,\n      next,\n      close\n    };\n\n  }\n\n  protected onAfterAttach(msg: Message): void {\n    super.onAfterAttach(msg);\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    this.addEventListener(this.input, 'selectstart' as any, () => false);\n  }\n\n}\n\nexport namespace SearchBox {\n\n  /**\n   * CSS classes for the search box widget.\n   */\n  export namespace Styles {\n\n    export const SEARCH_BOX = 'tart-search-box';\n    export const SEARCH_INPUT = 'tart-search-input';\n    export const SEARCH_BUTTONS_WRAPPER = 'tart-search-buttons-wrapper';\n    export const BUTTON = 'tart-search-button';\n    export const FILTER = ['codicon', 'codicon-filter'];\n    export const FILTER_ON = 'filter-active';\n    export const BUTTON_PREVIOUS = 'tart-search-button-previous';\n    export const BUTTON_NEXT = 'tart-search-button-next';\n    export const BUTTON_CLOSE = 'tart-search-button-close';\n    export const NON_SELECTABLE = 'tart-non-selectable';\n    export const NO_MATCH = 'no-match';\n  }\n\n  export interface HighlightInfo {\n    filterText: string | undefined,\n    matched: number,\n    total: number\n  }\n\n}\n\n/**\n * Search box factory.\n */\nexport const SearchBoxFactory = Symbol('SearchBoxFactory');\n\nexport interface SearchBoxFactory {\n\n  /**\n   * Creates a new search box with the given initializer properties.\n   */\n  (props: SearchBoxProps): SearchBox;\n\n}\n"]}