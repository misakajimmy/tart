{"version":3,"sources":["browser/browser.ts"],"names":[],"mappings":"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","file":"../../src/browser/browser.js","sourcesContent":["/********************************************************************************\n * Copyright (C) 2017 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nconst userAgent = typeof navigator !== 'undefined' ? navigator.userAgent : '';\n\nexport const isIE = (userAgent.indexOf('Trident') >= 0);\nexport const isEdge = (userAgent.indexOf('Edge/') >= 0);\nexport const isEdgeOrIE = isIE || isEdge;\n\nexport const isOpera = (userAgent.indexOf('Opera') >= 0);\nexport const isFirefox = (userAgent.indexOf('Firefox') >= 0);\nexport const isWebKit = (userAgent.indexOf('AppleWebKit') >= 0);\nexport const isChrome = (userAgent.indexOf('Chrome') >= 0);\nexport const isSafari = (userAgent.indexOf('Chrome') === -1) && (userAgent.indexOf('Safari') >= 0);\nexport const isIPad = (userAgent.indexOf('iPad') >= 0);\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport const isNative = typeof (window as any).process !== 'undefined';\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport const isBasicWasmSupported = typeof (window as any).WebAssembly !== 'undefined';\n\n/**\n * Resolves after the next animation frame if no parameter is given,\n * or after the given number of animation frames.\n */\nexport function animationFrame(n: number = 1): Promise<void> {\n  return new Promise(resolve => {\n    function frameFunc(): void {\n      if (n <= 0) {\n        resolve();\n      } else {\n        n--;\n        requestAnimationFrame(frameFunc);\n      }\n    }\n\n    frameFunc();\n  });\n}\n\n/**\n * Parse a magnitude value (e.g. width, height, left, top) from a CSS attribute value.\n * Returns the given default value (or undefined) if the value cannot be determined,\n * e.g. because it is a relative value like `50%` or `auto`.\n */\nexport function parseCssMagnitude(value: string | null, defaultValue: number): number;\nexport function parseCssMagnitude(value: string | null, defaultValue?: number): number | undefined {\n  if (value) {\n    let parsed: number;\n    if (value.endsWith('px')) {\n      parsed = parseFloat(value.substring(0, value.length - 2));\n    } else {\n      parsed = parseFloat(value);\n    }\n    if (!isNaN(parsed)) {\n      return parsed;\n    }\n  }\n  return defaultValue;\n}\n\n/**\n * Parse the number of milliseconds from a CSS time value.\n * Returns the given default value (or undefined) if the value cannot be determined.\n */\nexport function parseCssTime(time: string | null, defaultValue: number): number;\nexport function parseCssTime(time: string | null, defaultValue?: number): number | undefined {\n  if (time) {\n    let parsed: number;\n    if (time.endsWith('ms')) {\n      parsed = parseFloat(time.substring(0, time.length - 2));\n    } else if (time.endsWith('s')) {\n      parsed = parseFloat(time.substring(0, time.length - 1)) * 1000;\n    } else {\n      parsed = parseFloat(time);\n    }\n    if (!isNaN(parsed)) {\n      return parsed;\n    }\n  }\n  return defaultValue;\n}\n\ninterface ElementScroll {\n  left: number\n  top: number\n  maxLeft: number\n  maxTop: number\n}\n\nfunction getMonacoEditorScroll(elem: HTMLElement): ElementScroll | undefined {\n  const linesContent = elem.querySelector('.lines-content') as HTMLElement;\n  const viewLines = elem.querySelector('.view-lines') as HTMLElement;\n  // eslint-disable-next-line no-null/no-null\n  if (linesContent === null || viewLines === null) {\n    return undefined;\n  }\n  const linesContentStyle = linesContent.style;\n  const elemStyle = elem.style;\n  const viewLinesStyle = viewLines.style;\n  return {\n    left: -parseCssMagnitude(linesContentStyle.left, 0),\n    top: -parseCssMagnitude(linesContentStyle.top, 0),\n    maxLeft: parseCssMagnitude(viewLinesStyle.width, 0) - parseCssMagnitude(elemStyle.width, 0),\n    maxTop: parseCssMagnitude(viewLinesStyle.height, 0) - parseCssMagnitude(elemStyle.height, 0)\n  };\n}\n\n/**\n * Prevent browser back/forward navigation of a mouse wheel event.\n */\nexport function preventNavigation(event: WheelEvent): void {\n  const {currentTarget, deltaX, deltaY} = event;\n  const absDeltaX = Math.abs(deltaX);\n  const absDeltaY = Math.abs(deltaY);\n  let elem = event.target as Element | null;\n\n  while (elem && elem !== currentTarget) {\n    let scroll: ElementScroll | undefined;\n    if (elem.classList.contains('monaco-scrollable-element')) {\n      scroll = getMonacoEditorScroll(elem as HTMLElement);\n    } else {\n      scroll = {\n        left: elem.scrollLeft,\n        top: elem.scrollTop,\n        maxLeft: elem.scrollWidth - elem.clientWidth,\n        maxTop: elem.scrollHeight - elem.clientHeight\n      };\n    }\n    if (scroll) {\n      const scrollH = scroll.maxLeft > 0 && (deltaX < 0 && scroll.left > 0 || deltaX > 0 && scroll.left < scroll.maxLeft);\n      const scrollV = scroll.maxTop > 0 && (deltaY < 0 && scroll.top > 0 || deltaY > 0 && scroll.top < scroll.maxTop);\n      if (scrollH && scrollV || scrollH && absDeltaX > absDeltaY || scrollV && absDeltaY > absDeltaX) {\n        // The event is consumed by the scrollable child element\n        return;\n      }\n    }\n    elem = elem.parentElement;\n  }\n\n  event.preventDefault();\n  event.stopPropagation();\n}\n"]}