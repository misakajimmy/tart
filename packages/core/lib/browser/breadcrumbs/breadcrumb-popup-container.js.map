{"version":3,"sources":["browser/breadcrumbs/breadcrumb-popup-container.ts"],"names":[],"mappings":"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","file":"../../../src/browser/breadcrumbs/breadcrumb-popup-container.js","sourcesContent":["/********************************************************************************\n * Copyright (C) 2019 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport {inject, injectable, postConstruct} from 'inversify';\nimport {Emitter, Event} from '../../common';\nimport {Disposable, DisposableCollection} from '../../common/disposable';\nimport {Coordinate} from '../context-menu-renderer';\nimport {RendererHost} from '../widgets/react-renderer';\nimport {Styles} from './breadcrumbs-constants';\n\nexport interface BreadcrumbPopupContainerFactory {\n  (parent: HTMLElement, breadcrumbId: string, position: Coordinate): BreadcrumbPopupContainer;\n}\n\nexport const BreadcrumbPopupContainerFactory = Symbol('BreadcrumbPopupContainerFactory');\n\nexport type BreadcrumbID = string;\nexport const BreadcrumbID = Symbol('BreadcrumbID');\n\n/**\n * This class creates a popup container at the given position\n * so that contributions can attach their HTML elements\n * as children of `BreadcrumbPopupContainer#container`.\n *\n * - `dispose()` is called on blur or on hit on escape\n */\n@injectable()\nexport class BreadcrumbPopupContainer implements Disposable {\n  @inject(BreadcrumbID) public readonly breadcrumbId: BreadcrumbID;\n  @inject(RendererHost) protected readonly parent: RendererHost;\n  @inject(Coordinate) protected readonly position: Coordinate;\n\n  protected onDidDisposeEmitter = new Emitter<void>();\n  protected toDispose: DisposableCollection = new DisposableCollection(this.onDidDisposeEmitter);\n\n  get onDidDispose(): Event<void> {\n    return this.onDidDisposeEmitter.event;\n  }\n\n  protected _container: HTMLElement;\n  get container(): HTMLElement {\n    return this._container;\n  }\n\n  protected _isOpen: boolean;\n  get isOpen(): boolean {\n    return this._isOpen;\n  }\n\n  dispose(): void {\n    if (!this.toDispose.disposed) {\n      this.onDidDisposeEmitter.fire();\n      this.toDispose.dispose();\n      this._container.remove();\n      this._isOpen = false;\n      document.removeEventListener('keyup', this.escFunction);\n    }\n  }\n\n  @postConstruct()\n  protected init(): void {\n    this._container = this.createPopupDiv(this.position);\n    document.addEventListener('keyup', this.escFunction);\n    this._container.focus();\n    this._isOpen = true;\n  }\n\n  protected createPopupDiv(position: Coordinate): HTMLDivElement {\n    const result = window.document.createElement('div');\n    result.className = Styles.BREADCRUMB_POPUP;\n    result.style.left = `${position.x}px`;\n    result.style.top = `${position.y}px`;\n    result.tabIndex = 0;\n    result.addEventListener('focusout', this.onFocusOut);\n    this.parent.appendChild(result);\n    return result;\n  }\n\n  protected onFocusOut = (event: FocusEvent) => {\n    if (!(event.relatedTarget instanceof Element) || !this._container.contains(event.relatedTarget)) {\n      this.dispose();\n    }\n  };\n\n  protected escFunction = (event: KeyboardEvent) => {\n    if (event.key === 'Escape' || event.key === 'Esc') {\n      this.dispose();\n    }\n  };\n}\n"]}