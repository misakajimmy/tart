{"version":3,"sources":["browser/editor.ts"],"names":[],"mappings":"AAAA,OAAO,EAAC,QAAQ,EAAE,QAAQ,EAAE,KAAK,EAAC,MAAM,6BAA6B,CAAC;AACtE,OAAO,KAAK,GAAG,MAAM,+CAA+C,CAAC;AACrE,OAAO,GAAG,MAAM,2BAA2B,CAAC;AAC5C,OAAO,EAAC,WAAW,EAAE,QAAQ,EAAE,MAAM,EAAC,MAAM,YAAY,CAAC;AACzD,OAAO,EAAC,UAAU,EAAE,KAAK,EAAE,SAAS,EAAE,8BAA8B,EAAC,MAAM,uBAAuB,CAAC;AACnG,OAAO,EAAC,gBAAgB,EAAC,MAAM,eAAe,CAAC;AAE/C,OAAO,EACL,QAAQ,EAAE,KAAK,EAAE,QAAQ,EAC1B,CAAC;AAEF,eAAO,MAAM,kBAAkB,eAA+B,CAAC;AAC/D,oBAAY,kBAAkB,GAAG,CAAC,GAAG,EAAE,GAAG,KAAK,OAAO,CAAC,UAAU,CAAC,CAAC;AAEnE,MAAM,WAAW,kBAAmB,SAAQ,GAAG,CAAC,YAAY,EAAE,QAAQ,EAAE,UAAU;IAChF,cAAc,CAAC,UAAU,EAAE,MAAM,GAAG,MAAM,CAAC;IAE3C,gBAAgB,CAAC,UAAU,EAAE,MAAM,GAAG,MAAM,CAAC;IAE7C,WAAW,CAAC,CAAC,OAAO,EAAE,kBAAkB,GAAG,SAAS,EAAE,CAAC;CACxD;AAED,MAAM,WAAW,uBAAuB;IACtC,QAAQ,CAAC,QAAQ,EAAE,kBAAkB,CAAC;IACtC,QAAQ,CAAC,cAAc,EAAE,8BAA8B,EAAE,CAAC;CAC3D;AAED,MAAM,WAAW,gBAAgB;IAC/B,QAAQ,CAAC,KAAK,EAAE,UAAU,CAAC;IAC3B,QAAQ,CAAC,MAAM,EAAE,WAAW,CAAC;CAC9B;AAED;;;GAGG;AACH,oBAAY,eAAe;IACzB;;OAEG;IACH,OAAO,IAAI;IACX;;OAEG;IACH,QAAQ,IAAI;IACZ;;OAEG;IACH,mBAAmB,IAAI;IACvB;;OAEG;IACH,mBAAmB,IAAI;IACvB;;OAEG;IACH,uBAAuB,IAAI;IAC3B;;OAEG;IACH,gBAAgB,IAAI;IACpB;;OAEG;IACH,YAAY,IAAI;IAChB;;OAEG;IACH,aAAa,IAAI;IACjB;;OAEG;IACH,iBAAiB,IAAI;IACrB;;OAEG;IACH,cAAc,IAAI;IAClB;;OAEG;IACH,cAAc,KAAK;IACnB;;OAEG;IACH,SAAS,KAAK;IACd;;OAEG;IACH,cAAc,KAAK;IACnB;;OAEG;IACH,cAAc,KAAK;CACpB;AAED,MAAM,WAAW,WAAW;IAC1B;;OAEG;IACH,QAAQ,CAAC,OAAO,CAAC,EAAE,OAAO,CAAC;IAC3B;;OAEG;IACH,QAAQ,CAAC,IAAI,EAAE,eAAe,CAAC;IAC/B;;OAEG;IACH,QAAQ,CAAC,QAAQ,CAAC,EAAE,QAAQ,CAAC;IAC7B;;OAEG;IACH,QAAQ,CAAC,WAAW,EAAE,MAAM,CAAC;IAC7B;;OAEG;IACH,QAAQ,CAAC,KAAK,CAAC,EAAE,KAAK,CAAC;IACvB;;OAEG;IAEH,QAAQ,CAAC,MAAM,EAAE,GAAG,CAAC;CACtB;AAED,0BAAkB,YAAY;IAE5B;;OAEG;IACH,MAAM,IAAA;IAEN;;OAEG;IACH,MAAM,IAAA;CACP;AAED;;GAEG;AACH,MAAM,WAAW,kBAAkB;IACjC;;OAEG;IACH,YAAY,EAAE,MAAM,CAAC;IACrB;;OAEG;IACH,OAAO,EAAE,OAAO,CAAC;IACjB;;OAEG;IACH,SAAS,EAAE,OAAO,CAAC;IACnB;;OAEG;IACH,cAAc,EAAE,OAAO,CAAC;IACxB;;OAEG;IACH,gBAAgB,CAAC,EAAE,MAAM,CAAC;CAC3B;AAED;;GAEG;AACH,MAAM,WAAW,SAAS;IACxB;;OAEG;IACH,QAAQ,CAAC,OAAO,EAAE,MAAM,EAAE,CAAC;IAC3B;;OAEG;IACH,QAAQ,CAAC,KAAK,EAAE,KAAK,CAAC;CACvB;AAED,MAAM,WAAW,UAAW,SAAQ,UAAU,EAAE,WAAW;IACzD,QAAQ,CAAC,IAAI,EAAE,WAAW,CAAC;IAE3B,QAAQ,CAAC,GAAG,EAAE,GAAG,CAAC;IAClB,QAAQ,CAAC,QAAQ,EAAE,kBAAkB,CAAC;IACtC,QAAQ,CAAC,wBAAwB,EAAE,KAAK,CAAC,uBAAuB,CAAC,CAAC;IAGlE,MAAM,EAAE,QAAQ,CAAC;IACjB,QAAQ,CAAC,uBAAuB,EAAE,KAAK,CAAC,QAAQ,CAAC,CAAC;IAElD,SAAS,EAAE,KAAK,CAAC;IACjB,QAAQ,CAAC,kBAAkB,EAAE,KAAK,CAAC,KAAK,CAAC,CAAC;IAC1C,QAAQ,CAAC,cAAc,EAAE,KAAK,CAAC,OAAO,CAAC,CAAC;IACxC,QAAQ,CAAC,WAAW,EAAE,KAAK,CAAC,gBAAgB,CAAC,CAAC;IAC9C,QAAQ,CAAC,eAAe,EAAE,KAAK,CAAC,IAAI,CAAC,CAAC;IACtC,QAAQ,CAAC,iBAAiB,EAAE,KAAK,CAAC,MAAM,CAAC,CAAC;IAC1C,QAAQ,CAAC,iBAAiB,EAAE,KAAK,CAAC,MAAM,CAAC,CAAC;IAE1C;;;OAGG;IACH,KAAK,IAAI,IAAI,CAAC;IAEd,IAAI,IAAI,IAAI,CAAC;IAEb,SAAS,IAAI,OAAO,CAAC;IAErB,gBAAgB,IAAI,KAAK,EAAE,CAAC;IAE5B,cAAc,CAAC,QAAQ,EAAE,QAAQ,EAAE,OAAO,CAAC,EAAE,qBAAqB,GAAG,IAAI,CAAC;IAE1E,WAAW,CAAC,KAAK,EAAE,KAAK,EAAE,OAAO,CAAC,EAAE,kBAAkB,GAAG,IAAI,CAAC;IAE9D;;OAEG;IACH,OAAO,IAAI,IAAI,CAAC;IAEhB;;OAEG;IACH,WAAW,IAAI,IAAI,CAAC;IAEpB,OAAO,CAAC,IAAI,EAAE,SAAS,GAAG,IAAI,CAAC;IAE/B;;;;OAIG;IACH,gBAAgB,CAAC,MAAM,EAAE,qBAAqB,GAAG,MAAM,EAAE,CAAC;IAE1D;;;;;OAKG;IACH,mBAAmB,CAAC,eAAe,EAAE,MAAM,EAAE,aAAa,EAAE,MAAM,GAAG,gBAAgB,EAAE,CAAC;IAExF,gBAAgB,CAAC,QAAQ,EAAE,QAAQ,GAAG,MAAM,CAAC;IAE7C;;;OAGG;IACH,WAAW,CAAC,MAAM,EAAE,iBAAiB,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC;IAEzD;;;OAGG;IACH,YAAY,CAAC,KAAK,EAAE,GAAG,CAAC,QAAQ,EAAE,GAAG,OAAO,CAAC;IAE7C,cAAc,IAAI,MAAM,CAAC;IAEzB,gBAAgB,CAAC,KAAK,EAAE,MAAM,GAAG,IAAI,CAAC;IAEtC,cAAc,IAAI,IAAI,CAAC;IAEvB,WAAW,CAAC,UAAU,EAAE,MAAM,GAAG,IAAI,CAAC;IAEtC;;OAEG;IACH,WAAW,IAAI,MAAM,CAAC;IAEtB;;OAEG;IACH,WAAW,CAAC,QAAQ,EAAE,MAAM,EAAE,IAAI,EAAE,YAAY,GAAG,IAAI,CAAC;CACzD;AAED,MAAM,WAAW,mBAAmB;IAClC,GAAG,EAAE,GAAG,CAAA;IACR,MAAM,CAAC,EAAE,QAAQ,CAAA;IACjB,SAAS,CAAC,EAAE,KAAK,CAAA;CAClB;AAGD,MAAM,WAAW,SAAS;IACxB,KAAK,EAAE,MAAM,CAAC;IACd,MAAM,EAAE,MAAM,CAAC;CAChB;AAED,MAAM,WAAW,qBAAqB;IACpC,QAAQ,EAAE,MAAM,GAAG,QAAQ,GAAG,yBAAyB,CAAC;IACxD,UAAU,CAAC,EAAE,OAAO,CAAC;CACtB;AAED,MAAM,WAAW,kBAAkB;IACjC,EAAE,EAAE,MAAM,GAAG,QAAQ,GAAG,KAAK,GAAG,yBAAyB,CAAC;CAC3D;AAED,MAAM,WAAW,qBAAqB;IACpC,cAAc,EAAE,MAAM,EAAE,CAAC;IACzB,cAAc,EAAE,gBAAgB,EAAE,CAAC;CACpC;AAED,MAAM,WAAW,iBAAiB;IAChC;;OAEG;IACH,MAAM,EAAE,MAAM,CAAC;IACf;;OAEG;IACH,iBAAiB,EAAE,gBAAgB,EAAE,CAAC;CACvC;AAED,MAAM,WAAW,gBAAgB;IAC/B;;OAEG;IACH,KAAK,EAAE,KAAK,CAAC;IACb;;OAEG;IACH,IAAI,EAAE,MAAM,CAAC;CACd;AAED,yBAAiB,mBAAmB,CAAC;IAEnC,SAAgB,EAAE,CAAC,CAAC,EAAE,GAAG,GAAG,CAAC,IAAI,mBAAmB,CAEnD;CACF;AAED,yBAAiB,kBAAkB,CAAC;IAClC,SAAgB,EAAE,CAAC,GAAG,EAAE,MAAM,GAAG,SAAS,GAAG,GAAG,IAAI,kBAAkB,CAErE;CACF;AAED,MAAM,WAAW,kBAAmB,SAAQ,MAAM;IAEhD,QAAQ,CAAC,QAAQ,EAAE,SAAS,CAAC,GAAG,CAAC,CAAC;CACnC","file":"../../src/browser/editor.d.ts","sourcesContent":["import {Location, Position, Range} from 'vscode-languageserver-types';\r\nimport * as lsp from '@tart/core/shared/vscode-languageserver-types';\r\nimport URI from '@tart/core/lib/common/uri';\r\nimport {Navigatable, Saveable, Widget} from '@tart/core';\r\nimport {Disposable, Event, Reference, TextDocumentContentChangeDelta} from '@tart/core/lib/common';\r\nimport {EditorDecoration} from './decorations';\r\n\r\nexport {\r\n  Position, Range, Location\r\n};\r\n\r\nexport const TextEditorProvider = Symbol('TextEditorProvider');\r\nexport type TextEditorProvider = (uri: URI) => Promise<TextEditor>;\r\n\r\nexport interface TextEditorDocument extends lsp.TextDocument, Saveable, Disposable {\r\n  getLineContent(lineNumber: number): string;\r\n\r\n  getLineMaxColumn(lineNumber: number): number;\r\n\r\n  findMatches?(options: FindMatchesOptions): FindMatch[];\r\n}\r\n\r\nexport interface TextDocumentChangeEvent {\r\n  readonly document: TextEditorDocument;\r\n  readonly contentChanges: TextDocumentContentChangeDelta[];\r\n}\r\n\r\nexport interface EditorMouseEvent {\r\n  readonly event: MouseEvent;\r\n  readonly target: MouseTarget;\r\n}\r\n\r\n/**\r\n * Type of hit element with the mouse in the editor.\r\n * Copied from monaco editor.\r\n */\r\nexport enum MouseTargetType {\r\n  /**\r\n   * Mouse is on top of an unknown element.\r\n   */\r\n  UNKNOWN = 0,\r\n  /**\r\n   * Mouse is on top of the textarea used for input.\r\n   */\r\n  TEXTAREA = 1,\r\n  /**\r\n   * Mouse is on top of the glyph margin\r\n   */\r\n  GUTTER_GLYPH_MARGIN = 2,\r\n  /**\r\n   * Mouse is on top of the line numbers\r\n   */\r\n  GUTTER_LINE_NUMBERS = 3,\r\n  /**\r\n   * Mouse is on top of the line decorations\r\n   */\r\n  GUTTER_LINE_DECORATIONS = 4,\r\n  /**\r\n   * Mouse is on top of the whitespace left in the gutter by a view zone.\r\n   */\r\n  GUTTER_VIEW_ZONE = 5,\r\n  /**\r\n   * Mouse is on top of text in the content.\r\n   */\r\n  CONTENT_TEXT = 6,\r\n  /**\r\n   * Mouse is on top of empty space in the content (e.g. after line text or below last line)\r\n   */\r\n  CONTENT_EMPTY = 7,\r\n  /**\r\n   * Mouse is on top of a view zone in the content.\r\n   */\r\n  CONTENT_VIEW_ZONE = 8,\r\n  /**\r\n   * Mouse is on top of a content widget.\r\n   */\r\n  CONTENT_WIDGET = 9,\r\n  /**\r\n   * Mouse is on top of the decorations overview ruler.\r\n   */\r\n  OVERVIEW_RULER = 10,\r\n  /**\r\n   * Mouse is on top of a scrollbar.\r\n   */\r\n  SCROLLBAR = 11,\r\n  /**\r\n   * Mouse is on top of an overlay widget.\r\n   */\r\n  OVERLAY_WIDGET = 12,\r\n  /**\r\n   * Mouse is outside of the editor.\r\n   */\r\n  OUTSIDE_EDITOR = 13,\r\n}\r\n\r\nexport interface MouseTarget {\r\n  /**\r\n   * The target element\r\n   */\r\n  readonly element?: Element;\r\n  /**\r\n   * The target type\r\n   */\r\n  readonly type: MouseTargetType;\r\n  /**\r\n   * The 'approximate' editor position\r\n   */\r\n  readonly position?: Position;\r\n  /**\r\n   * Desired mouse column (e.g. when position.column gets clamped to text length -- clicking after text on a line).\r\n   */\r\n  readonly mouseColumn: number;\r\n  /**\r\n   * The 'approximate' editor range\r\n   */\r\n  readonly range?: Range;\r\n  /**\r\n   * Some extra detail.\r\n   */\r\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n  readonly detail: any;\r\n}\r\n\r\nexport const enum EncodingMode {\r\n\r\n  /**\r\n   * Instructs the encoding support to encode the current input with the provided encoding\r\n   */\r\n  Encode,\r\n\r\n  /**\r\n   * Instructs the encoding support to decode the current input with the provided encoding\r\n   */\r\n  Decode\r\n}\r\n\r\n/**\r\n * Options for searching in an editor.\r\n */\r\nexport interface FindMatchesOptions {\r\n  /**\r\n   * The string used to search. If it is a regular expression, set `isRegex` to true.\r\n   */\r\n  searchString: string;\r\n  /**\r\n   * Used to indicate that `searchString` is a regular expression.\r\n   */\r\n  isRegex: boolean;\r\n  /**\r\n   * Force the matching to match lower/upper case exactly.\r\n   */\r\n  matchCase: boolean;\r\n  /**\r\n   * Force the matching to match entire words only.\r\n   */\r\n  matchWholeWord: boolean;\r\n  /**\r\n   * Limit the number of results.\r\n   */\r\n  limitResultCount?: number;\r\n}\r\n\r\n/**\r\n * Representation of a find match.\r\n */\r\nexport interface FindMatch {\r\n  /**\r\n   * The textual match.\r\n   */\r\n  readonly matches: string[];\r\n  /**\r\n   * The range for the given match.\r\n   */\r\n  readonly range: Range;\r\n}\r\n\r\nexport interface TextEditor extends Disposable, Navigatable {\r\n  readonly node: HTMLElement;\r\n\r\n  readonly uri: URI;\r\n  readonly document: TextEditorDocument;\r\n  readonly onDocumentContentChanged: Event<TextDocumentChangeEvent>;\r\n\r\n\r\n  cursor: Position;\r\n  readonly onCursorPositionChanged: Event<Position>;\r\n\r\n  selection: Range;\r\n  readonly onSelectionChanged: Event<Range>;\r\n  readonly onFocusChanged: Event<boolean>;\r\n  readonly onMouseDown: Event<EditorMouseEvent>;\r\n  readonly onScrollChanged: Event<void>;\r\n  readonly onLanguageChanged: Event<string>;\r\n  readonly onEncodingChanged: Event<string>;\r\n\r\n  /**\r\n   * The text editor should be revealed,\r\n   * otherwise it won't receive the focus.\r\n   */\r\n  focus(): void;\r\n\r\n  blur(): void;\r\n\r\n  isFocused(): boolean;\r\n\r\n  getVisibleRanges(): Range[];\r\n\r\n  revealPosition(position: Position, options?: RevealPositionOptions): void;\r\n\r\n  revealRange(range: Range, options?: RevealRangeOptions): void;\r\n\r\n  /**\r\n   * Rerender the editor.\r\n   */\r\n  refresh(): void;\r\n\r\n  /**\r\n   * Resize the editor to fit its node.\r\n   */\r\n  resizeToFit(): void;\r\n\r\n  setSize(size: Dimension): void;\r\n\r\n  /**\r\n   * Applies given new decorations, and removes old decorations identified by ids.\r\n   *\r\n   * @returns identifiers of applied decorations, which can be removed in next call.\r\n   */\r\n  deltaDecorations(params: DeltaDecorationParams): string[];\r\n\r\n  /**\r\n   * Gets all the decorations for the lines between `startLineNumber` and `endLineNumber` as an array.\r\n   * @param startLineNumber The start line number.\r\n   * @param endLineNumber The end line number.\r\n   * @return An array with the decorations.\r\n   */\r\n  getLinesDecorations(startLineNumber: number, endLineNumber: number): EditorDecoration[];\r\n\r\n  getVisibleColumn(position: Position): number;\r\n\r\n  /**\r\n   * Replaces the text of source given in ReplaceTextParams.\r\n   * @param params: ReplaceTextParams\r\n   */\r\n  replaceText(params: ReplaceTextParams): Promise<boolean>;\r\n\r\n  /**\r\n   * Execute edits on the editor.\r\n   * @param edits: edits created with `lsp.TextEdit.replace`, `lsp.TextEdit.insert`, `lsp.TextEdit.del`\r\n   */\r\n  executeEdits(edits: lsp.TextEdit[]): boolean;\r\n\r\n  storeViewState(): object;\r\n\r\n  restoreViewState(state: object): void;\r\n\r\n  detectLanguage(): void;\r\n\r\n  setLanguage(languageId: string): void;\r\n\r\n  /**\r\n   * Gets the encoding of the input if known.\r\n   */\r\n  getEncoding(): string;\r\n\r\n  /**\r\n   * Sets the encoding for the input for saving.\r\n   */\r\n  setEncoding(encoding: string, mode: EncodingMode): void;\r\n}\r\n\r\nexport interface TextEditorSelection {\r\n  uri: URI\r\n  cursor?: Position\r\n  selection?: Range\r\n}\r\n\r\n\r\nexport interface Dimension {\r\n  width: number;\r\n  height: number;\r\n}\r\n\r\nexport interface RevealPositionOptions {\r\n  vertical: 'auto' | 'center' | 'centerIfOutsideViewport';\r\n  horizontal?: boolean;\r\n}\r\n\r\nexport interface RevealRangeOptions {\r\n  at: 'auto' | 'center' | 'top' | 'centerIfOutsideViewport';\r\n}\r\n\r\nexport interface DeltaDecorationParams {\r\n  oldDecorations: string[];\r\n  newDecorations: EditorDecoration[];\r\n}\r\n\r\nexport interface ReplaceTextParams {\r\n  /**\r\n   * the source to edit\r\n   */\r\n  source: string;\r\n  /**\r\n   * the replace operations\r\n   */\r\n  replaceOperations: ReplaceOperation[];\r\n}\r\n\r\nexport interface ReplaceOperation {\r\n  /**\r\n   * the position that shall be replaced\r\n   */\r\n  range: Range;\r\n  /**\r\n   * the text to replace with\r\n   */\r\n  text: string;\r\n}\r\n\r\nexport namespace TextEditorSelection {\r\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n  export function is(e: any): e is TextEditorSelection {\r\n    return e && e['uri'] instanceof URI;\r\n  }\r\n}\r\n\r\nexport namespace CustomEditorWidget {\r\n  export function is(arg: Widget | undefined): arg is CustomEditorWidget {\r\n    return !!arg && 'modelRef' in arg;\r\n  }\r\n}\r\n\r\nexport interface CustomEditorWidget extends Widget {\r\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n  readonly modelRef: Reference<any>;\r\n}\r\n"]}