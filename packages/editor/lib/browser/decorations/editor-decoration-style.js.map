{"version":3,"sources":["browser/decorations/editor-decoration-style.ts"],"names":[],"mappings":"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","file":"../../../src/browser/decorations/editor-decoration-style.js","sourcesContent":["/********************************************************************************\r\n * Copyright (C) 2018 TypeFox and others.\r\n *\r\n * This program and the accompanying materials are made available under the\r\n * terms of the Eclipse Public License v. 2.0 which is available at\r\n * http://www.eclipse.org/legal/epl-2.0.\r\n *\r\n * This Source Code may also be made available under the following Secondary\r\n * Licenses when the conditions for such availability set forth in the Eclipse\r\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\r\n * with the GNU Classpath Exception which is available at\r\n * https://www.gnu.org/software/classpath/license.html.\r\n *\r\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\r\n ********************************************************************************/\r\nimport {Disposable} from '@tart/core/lib/common';\r\n\r\n\r\nexport class EditorDecorationStyle implements Disposable {\r\n\r\n  constructor(\r\n      readonly selector: string,\r\n      styleProvider: (style: CSSStyleDeclaration) => void,\r\n  ) {\r\n    EditorDecorationStyle.createRule(selector, styleProvider);\r\n  }\r\n\r\n  get className(): string {\r\n    return this.selector.split('::')[0];\r\n  }\r\n\r\n  dispose(): void {\r\n    EditorDecorationStyle.deleteRule(this.selector);\r\n  }\r\n\r\n}\r\n\r\nexport namespace EditorDecorationStyle {\r\n\r\n  export function copyStyle(from: CSSStyleDeclaration, to: CSSStyleDeclaration): void {\r\n    Object.keys(from).forEach(key => {\r\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n      (<any>to)[key] = (<any>from)[key];\r\n    });\r\n  }\r\n\r\n  export function createStyleSheet(container: HTMLElement = document.getElementsByTagName('head')[0]): CSSStyleSheet | undefined {\r\n    if (!container) {\r\n      return undefined;\r\n    }\r\n    const style = document.createElement('style');\r\n    style.id = 'editorDecorationsStyle';\r\n    style.type = 'text/css';\r\n    style.media = 'screen';\r\n    style.appendChild(document.createTextNode('')); // trick for webkit\r\n    container.appendChild(style);\r\n    return <CSSStyleSheet>style.sheet;\r\n  }\r\n\r\n  const editorDecorationsStyleSheet: CSSStyleSheet | undefined = createStyleSheet();\r\n\r\n  export function createRule(selector: string, styleProvider: (style: CSSStyleDeclaration) => void,\r\n                             styleSheet: CSSStyleSheet | undefined = editorDecorationsStyleSheet\r\n  ): void {\r\n    if (!styleSheet) {\r\n      return;\r\n    }\r\n    const index = styleSheet.insertRule('.' + selector + '{}', 0);\r\n    const rules = styleSheet.cssRules || styleSheet.rules;\r\n    const rule = rules[index];\r\n    if (rule && rule.type === CSSRule.STYLE_RULE) {\r\n      const styleRule = rule as CSSStyleRule;\r\n      styleProvider(styleRule.style);\r\n    }\r\n  }\r\n\r\n  export function deleteRule(selector: string, styleSheet: CSSStyleSheet | undefined = editorDecorationsStyleSheet): void {\r\n    if (!styleSheet) {\r\n      return;\r\n    }\r\n    const rules = styleSheet.cssRules || styleSheet.rules;\r\n    for (let i = 0; i < rules.length; i++) {\r\n      if (rules[i].type === CSSRule.STYLE_RULE) {\r\n        if ((rules[i] as CSSStyleRule).selectorText === selector) {\r\n          styleSheet.removeRule(i);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n}\r\n"]}