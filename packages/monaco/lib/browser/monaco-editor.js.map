{"version":3,"sources":["browser/monaco-editor.ts"],"names":[],"mappings":"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","file":"../../src/browser/monaco-editor.js","sourcesContent":["import {inject, injectable, unmanaged} from 'inversify';\r\nimport {\r\n  DeltaDecorationParams,\r\n  Dimension,\r\n  EditorMouseEvent,\r\n  EncodingMode,\r\n  Position,\r\n  Range,\r\n  ReplaceTextParams,\r\n  RevealPositionOptions,\r\n  RevealRangeOptions,\r\n  TextDocumentChangeEvent,\r\n  TextEditor\r\n} from '@tart/editor/lib/browser/editor';\r\nimport {ElementExt} from '@lumino/domutils'\r\nimport {Disposable, DisposableCollection, Emitter, Event, TextDocumentContentChangeDelta,} from '@tart/core/lib/common';\r\n\r\nimport URI from '@tart/core/lib/common/uri';\r\nimport {MonacoEditorModel} from './monaco-editor-model';\r\nimport {MonacoToProtocolConverter} from './monaco-to-protocol-converter';\r\nimport {ProtocolToMonacoConverter} from './protocol-to-monaco-converter';\r\nimport {ContextKeyService} from '@tart/core/lib/browser/context-key-service';\r\nimport {UTF8} from '@tart/core/lib/common/encodings';\r\nimport {TextEdit} from 'vscode-languageserver-types';\r\nimport IStandaloneEditorConstructionOptions = monaco.editor.IStandaloneEditorConstructionOptions;\r\nimport IModelDeltaDecoration = monaco.editor.IModelDeltaDecoration;\r\nimport IEditorOverrideServices = monaco.editor.IEditorOverrideServices;\r\nimport IStandaloneCodeEditor = monaco.editor.IStandaloneCodeEditor;\r\nimport IIdentifiedSingleEditOperation = monaco.editor.IIdentifiedSingleEditOperation;\r\nimport IBoxSizing = ElementExt.IBoxSizing;\r\nimport {EditorDecoration} from '@tart/editor/lib/browser/decorations/editor-decoration';\r\nimport {EditorManager} from '@tart/editor/lib/browser/editor-manager';\r\nimport {EditorWidget} from '@tart/editor/lib/browser/editor-widget';\r\n\r\n\r\n@injectable()\r\nexport class MonacoEditorServices {\r\n\r\n  @inject(MonacoToProtocolConverter)\r\n  protected readonly m2p: MonacoToProtocolConverter;\r\n\r\n  @inject(ProtocolToMonacoConverter)\r\n  protected readonly p2m: ProtocolToMonacoConverter;\r\n\r\n  @inject(ContextKeyService)\r\n  protected readonly contextKeyService: ContextKeyService;\r\n\r\n  constructor(@unmanaged() services: MonacoEditorServices) {\r\n    Object.assign(this, services);\r\n  }\r\n}\r\n\r\nexport class MonacoEditor extends MonacoEditorServices implements TextEditor {\r\n\r\n  onEncodingChanged: Event<string>;\r\n  readonly documents = new Set<MonacoEditorModel>();\r\n  protected readonly toDispose = new DisposableCollection();\r\n  protected readonly autoSizing: boolean;\r\n  protected readonly minHeight: number;\r\n  protected readonly maxHeight: number;\r\n  protected editor: IStandaloneCodeEditor;\r\n  protected readonly onCursorPositionChangedEmitter = new Emitter<Position>();\r\n  protected readonly onSelectionChangedEmitter = new Emitter<Range>();\r\n  protected readonly onFocusChangedEmitter = new Emitter<boolean>();\r\n  protected readonly onDocumentContentChangedEmitter = new Emitter<TextDocumentChangeEvent>();\r\n  protected readonly onMouseDownEmitter = new Emitter<EditorMouseEvent>();\r\n  protected readonly onLanguageChangedEmitter = new Emitter<string>();\r\n  readonly onLanguageChanged = this.onLanguageChangedEmitter.event;\r\n  protected readonly onScrollChangedEmitter = new Emitter<void>();\r\n  // eslint-disable-next-line no-null/no-null\r\n  protected readonly onResizeEmitter = new Emitter<Dimension | null>();\r\n  readonly onDidResize = this.onResizeEmitter.event;\r\n\r\n  constructor(\r\n      readonly uri: URI,\r\n      readonly document: MonacoEditorModel,\r\n      readonly node: HTMLElement,\r\n      services: MonacoEditorServices,\r\n      options?: MonacoEditor.IOptions,\r\n      override?: IEditorOverrideServices\r\n  ) {\r\n    super(services);\r\n    this.toDispose.pushAll([\r\n      this.onCursorPositionChangedEmitter,\r\n      this.onSelectionChangedEmitter,\r\n      this.onFocusChangedEmitter,\r\n      this.onDocumentContentChangedEmitter,\r\n      this.onMouseDownEmitter,\r\n      this.onLanguageChangedEmitter,\r\n      this.onScrollChangedEmitter\r\n    ]);\r\n    this.document = document;\r\n    this.onEncodingChanged = this.document.onDidChangeEncoding;\r\n    this.documents.add(document);\r\n\r\n    this.autoSizing = options && options.autoSizing !== undefined ? options.autoSizing : false;\r\n    this.minHeight = options && options.minHeight !== undefined ? options.minHeight : -1;\r\n    this.maxHeight = options && options.maxHeight !== undefined ? options.maxHeight : -1;\r\n    this.toDispose.push(this.create(options, override));\r\n    this.addHandlers(this.editor);\r\n  }\r\n\r\n  get onDispose(): Event<void> {\r\n    return this.toDispose.onDispose;\r\n  }\r\n\r\n  get onDocumentContentChanged(): Event<TextDocumentChangeEvent> {\r\n    return this.onDocumentContentChangedEmitter.event;\r\n  }\r\n\r\n  get cursor(): Position {\r\n    const {lineNumber, column} = this.editor.getPosition()!;\r\n    return this.m2p.asPosition(lineNumber, column);\r\n  }\r\n\r\n  set cursor(cursor: Position) {\r\n    const position = this.p2m.asPosition(cursor);\r\n    this.editor.setPosition(position);\r\n  }\r\n\r\n  get onCursorPositionChanged(): Event<Position> {\r\n    return this.onCursorPositionChangedEmitter.event;\r\n  }\r\n\r\n  get selection(): Range {\r\n    return this.m2p.asRange(this.editor.getSelection()!);\r\n  }\r\n\r\n  set selection(selection: Range) {\r\n    const range = this.p2m.asRange(selection);\r\n    this.editor.setSelection(range);\r\n  }\r\n\r\n  get onSelectionChanged(): Event<Range> {\r\n    return this.onSelectionChangedEmitter.event;\r\n  }\r\n\r\n  get onScrollChanged(): Event<void> {\r\n    return this.onScrollChangedEmitter.event;\r\n  }\r\n\r\n  get onFocusChanged(): Event<boolean> {\r\n    return this.onFocusChangedEmitter.event;\r\n  }\r\n\r\n  get onMouseDown(): Event<EditorMouseEvent> {\r\n    return this.onMouseDownEmitter.event;\r\n  }\r\n\r\n  get commandService(): monaco.commands.ICommandService {\r\n    return this.editor._commandService;\r\n  }\r\n\r\n  get instantiationService(): monaco.instantiation.IInstantiationService {\r\n    return this.editor._instantiationService;\r\n  }\r\n\r\n  /* `true` because it is derived from an URI during the instantiation */\r\n  protected _languageAutoDetected = true;\r\n\r\n  get languageAutoDetected(): boolean {\r\n    return this._languageAutoDetected;\r\n  }\r\n\r\n  getEncoding(): string {\r\n    return this.document.getEncoding() || UTF8;\r\n  }\r\n\r\n  setEncoding(encoding: string, mode: EncodingMode): Promise<void> {\r\n    return this.document.setEncoding(encoding, mode);\r\n  }\r\n\r\n  getVisibleRanges(): Range[] {\r\n    return this.editor.getVisibleRanges().map(range => this.m2p.asRange(range));\r\n  }\r\n\r\n  revealPosition(raw: Position, options: RevealPositionOptions = {vertical: 'center'}): void {\r\n    const position = this.p2m.asPosition(raw);\r\n    switch (options.vertical) {\r\n      case 'auto':\r\n        this.editor.revealPosition(position);\r\n        break;\r\n      case 'center':\r\n        this.editor.revealPositionInCenter(position);\r\n        break;\r\n      case 'centerIfOutsideViewport':\r\n        this.editor.revealPositionInCenterIfOutsideViewport(position);\r\n        break;\r\n    }\r\n  }\r\n\r\n  revealRange(raw: Range, options: RevealRangeOptions = {at: 'center'}): void {\r\n    const range = this.p2m.asRange(raw);\r\n    switch (options.at) {\r\n      case 'top':\r\n        this.editor.revealRangeAtTop(range!);\r\n        break;\r\n      case 'center':\r\n        this.editor.revealRangeInCenter(range!);\r\n        break;\r\n      case 'centerIfOutsideViewport':\r\n        this.editor.revealRangeInCenterIfOutsideViewport(range!);\r\n        break;\r\n      case 'auto':\r\n        this.editor.revealRange(range!);\r\n        break;\r\n    }\r\n  }\r\n\r\n  focus(): void {\r\n    /**\r\n     * `this.editor.focus` forcefully changes the focus editor state,\r\n     * regardless whether the textarea actually received the focus.\r\n     * It could lead to issues like https://github.com/eclipse-wm/wm/issues/7902\r\n     * Instead we focus the underlying textarea.\r\n     */\r\n    const node = this.editor.getDomNode();\r\n    if (node) {\r\n      const textarea = node.querySelector('textarea') as HTMLElement;\r\n      textarea.focus();\r\n    }\r\n  }\r\n\r\n  blur(): void {\r\n    const node = this.editor.getDomNode();\r\n    if (node) {\r\n      const textarea = node.querySelector('textarea') as HTMLElement;\r\n      textarea.blur();\r\n    }\r\n  }\r\n\r\n  isFocused({strict}: { strict: boolean } = {strict: false}): boolean {\r\n    if (!this.editor.hasTextFocus()) {\r\n      return false;\r\n    }\r\n    if (strict) {\r\n      return !this.isSuggestWidgetVisible() && !this.isFindWidgetVisible() && !this.isRenameInputVisible();\r\n    }\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * `true` if the suggest widget is visible in the editor. Otherwise, `false`.\r\n   */\r\n  isSuggestWidgetVisible(): boolean {\r\n    return this.contextKeyService.match('suggestWidgetVisible', this.editor.getDomNode() || this.node);\r\n  }\r\n\r\n  /**\r\n   * `true` if the find (and replace) widget is visible in the editor. Otherwise, `false`.\r\n   */\r\n  isFindWidgetVisible(): boolean {\r\n    return this.contextKeyService.match('findWidgetVisible', this.editor.getDomNode() || this.node);\r\n  }\r\n\r\n  /**\r\n   * `true` if the name rename refactoring input HTML element is visible. Otherwise, `false`.\r\n   */\r\n  isRenameInputVisible(): boolean {\r\n    return this.contextKeyService.match('renameInputVisible', this.editor.getDomNode() || this.node);\r\n  }\r\n\r\n  dispose(): void {\r\n    this.toDispose.dispose();\r\n  }\r\n\r\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n  trigger(source: string, handlerId: string, payload: any): void {\r\n    this.editor.trigger(source, handlerId, payload);\r\n  }\r\n\r\n  getControl(): IStandaloneCodeEditor {\r\n    return this.editor;\r\n  }\r\n\r\n  refresh(): void {\r\n    this.autoresize();\r\n  }\r\n\r\n  resizeToFit(): void {\r\n    this.autoresize();\r\n    // eslint-disable-next-line no-null/no-null\r\n    this.onResizeEmitter.fire(null);\r\n  }\r\n\r\n  setSize(dimension: Dimension): void {\r\n    this.resize(dimension);\r\n    this.onResizeEmitter.fire(dimension);\r\n  }\r\n\r\n  isActionSupported(id: string): boolean {\r\n    const action = this.editor.getAction(id);\r\n    return !!action && action.isSupported();\r\n  }\r\n\r\n  async runAction(id: string): Promise<void> {\r\n    const action = this.editor.getAction(id);\r\n    if (action && action.isSupported()) {\r\n      await action.run();\r\n    }\r\n  }\r\n\r\n  deltaDecorations(params: DeltaDecorationParams): string[] {\r\n    const oldDecorations = params.oldDecorations;\r\n    const newDecorations = this.toDeltaDecorations(params);\r\n    return this.editor.deltaDecorations(oldDecorations, newDecorations);\r\n  }\r\n\r\n  getLinesDecorations(startLineNumber: number, endLineNumber: number): (EditorDecoration & Readonly<{ id: string }>)[] {\r\n    const toPosition = (line: number): monaco.Position => this.p2m.asPosition({line, character: 0});\r\n    const start = toPosition(startLineNumber).lineNumber;\r\n    const end = toPosition(endLineNumber).lineNumber;\r\n    return this.editor\r\n        .getModel()!\r\n        .getLinesDecorations(start, end)\r\n        .map(this.toEditorDecoration.bind(this));\r\n  }\r\n\r\n  getVisibleColumn(position: Position): number {\r\n    return this.editor.getVisibleColumnFromPosition(this.p2m.asPosition(position));\r\n  }\r\n\r\n  async replaceText(params: ReplaceTextParams): Promise<boolean> {\r\n    const edits: IIdentifiedSingleEditOperation[] = params.replaceOperations.map(param => {\r\n      const range = monaco.Range.fromPositions(this.p2m.asPosition(param.range.start), this.p2m.asPosition(param.range.end));\r\n      return {\r\n        forceMoveMarkers: true,\r\n        identifier: {\r\n          major: range.startLineNumber,\r\n          minor: range.startColumn\r\n        },\r\n        range,\r\n        text: param.text\r\n      };\r\n    });\r\n    return this.editor.executeEdits(params.source, edits);\r\n  }\r\n\r\n  executeEdits(edits: TextEdit[]): boolean {\r\n    return this.editor.executeEdits('MonacoEditor', this.p2m.asTextEdits(edits) as IIdentifiedSingleEditOperation[]);\r\n  }\r\n\r\n  storeViewState(): object {\r\n    return this.editor.saveViewState()!;\r\n  }\r\n\r\n  restoreViewState(state: monaco.editor.ICodeEditorViewState): void {\r\n    this.editor.restoreViewState(state);\r\n  }\r\n\r\n  async detectLanguage(): Promise<void> {\r\n    const modeService = monaco.services.StaticServices.modeService.get();\r\n    const firstLine = this.document.textEditorModel.getLineContent(1);\r\n    const model = this.getControl().getModel();\r\n    const language = modeService.createByFilepathOrFirstLine(model && model.uri, firstLine);\r\n    this.setLanguage(language.languageIdentifier.language);\r\n    this._languageAutoDetected = true;\r\n  }\r\n\r\n  setLanguage(languageId: string): void {\r\n    for (const document of this.documents) {\r\n      monaco.editor.setModelLanguage(document.textEditorModel, languageId);\r\n    }\r\n  }\r\n\r\n  getResourceUri(): URI {\r\n    return this.uri;\r\n  }\r\n\r\n  createMoveToUri(resourceUri: URI): URI {\r\n    return this.uri.withPath(resourceUri.path);\r\n  }\r\n\r\n  protected create(options?: IStandaloneEditorConstructionOptions, override?: monaco.editor.IEditorOverrideServices): Disposable {\r\n    return this.editor = monaco.editor.create(this.node, {\r\n      ...options,\r\n      lightbulb: {enabled: true},\r\n      fixedOverflowWidgets: true,\r\n      scrollbar: {\r\n        useShadows: false,\r\n        verticalHasArrows: false,\r\n        horizontalHasArrows: false,\r\n        verticalScrollbarSize: 10,\r\n        horizontalScrollbarSize: 10\r\n      }\r\n    }, override);\r\n  }\r\n\r\n  protected addHandlers(codeEditor: IStandaloneCodeEditor): void {\r\n    this.toDispose.push(codeEditor.onDidChangeModelLanguage(e =>\r\n        this.fireLanguageChanged(e.newLanguage)\r\n    ));\r\n    this.toDispose.push(codeEditor.onDidChangeConfiguration(() => this.refresh()));\r\n    this.toDispose.push(codeEditor.onDidChangeModel(() => this.refresh()));\r\n    this.toDispose.push(codeEditor.onDidChangeModelContent(e => {\r\n      this.refresh();\r\n      this.onDocumentContentChangedEmitter.fire({\r\n        document: this.document,\r\n        contentChanges: e.changes.map(this.mapModelContentChange.bind(this))\r\n      });\r\n    }));\r\n    this.toDispose.push(codeEditor.onDidChangeCursorPosition(() =>\r\n        this.onCursorPositionChangedEmitter.fire(this.cursor)\r\n    ));\r\n    this.toDispose.push(codeEditor.onDidChangeCursorSelection(() =>\r\n        this.onSelectionChangedEmitter.fire(this.selection)\r\n    ));\r\n    this.toDispose.push(codeEditor.onDidFocusEditorText(() =>\r\n        this.onFocusChangedEmitter.fire(this.isFocused())\r\n    ));\r\n    this.toDispose.push(codeEditor.onDidBlurEditorText(() =>\r\n        this.onFocusChangedEmitter.fire(this.isFocused())\r\n    ));\r\n    this.toDispose.push(codeEditor.onMouseDown(e => {\r\n      const {element, position, range} = e.target;\r\n      this.onMouseDownEmitter.fire({\r\n        target: {\r\n          ...e.target,\r\n          element: element || undefined,\r\n          mouseColumn: this.m2p.asPosition(undefined, e.target.mouseColumn).character,\r\n          range: range && this.m2p.asRange(range) || undefined,\r\n          position: position && this.m2p.asPosition(position.lineNumber, position.column) || undefined\r\n        },\r\n        event: e.event.browserEvent\r\n      });\r\n    }));\r\n    this.toDispose.push(codeEditor.onDidScrollChange(e => {\r\n      this.onScrollChangedEmitter.fire(undefined);\r\n    }));\r\n  }\r\n\r\n  protected mapModelContentChange(change: monaco.editor.IModelContentChange): TextDocumentContentChangeDelta {\r\n    return {\r\n      range: this.m2p.asRange(change.range),\r\n      rangeLength: change.rangeLength,\r\n      text: change.text\r\n    };\r\n  }\r\n\r\n  protected autoresize(): void {\r\n    if (this.autoSizing) {\r\n      // eslint-disable-next-line no-null/no-null\r\n      this.resize(null);\r\n    }\r\n  }\r\n\r\n  protected resize(dimension: Dimension | null): void {\r\n    if (this.node) {\r\n      const layoutSize = this.computeLayoutSize(this.node, dimension);\r\n      this.editor.layout(layoutSize);\r\n    }\r\n  }\r\n\r\n  protected computeLayoutSize(hostNode: HTMLElement, dimension: monaco.editor.IDimension | null): monaco.editor.IDimension {\r\n    if (dimension && dimension.width >= 0 && dimension.height >= 0) {\r\n      return dimension;\r\n    }\r\n    const boxSizing = ElementExt.boxSizing(hostNode);\r\n\r\n    const width = (!dimension || dimension.width < 0) ?\r\n        this.getWidth(hostNode, boxSizing) :\r\n        dimension.width;\r\n\r\n    const height = (!dimension || dimension.height < 0) ?\r\n        this.getHeight(hostNode, boxSizing) :\r\n        dimension.height;\r\n\r\n    return {width, height};\r\n  }\r\n\r\n  protected getWidth(hostNode: HTMLElement, boxSizing: IBoxSizing): number {\r\n    return hostNode.offsetWidth - boxSizing.horizontalSum;\r\n  }\r\n\r\n  protected getHeight(hostNode: HTMLElement, boxSizing: IBoxSizing): number {\r\n    if (!this.autoSizing) {\r\n      return hostNode.offsetHeight - boxSizing.verticalSum;\r\n    }\r\n\r\n    const lineHeight = this.editor.getOption(monaco.editor.EditorOption.lineHeight);\r\n    const lineCount = this.editor.getModel()!.getLineCount();\r\n    const contentHeight = lineHeight * lineCount;\r\n\r\n    const horizontalScrollbarHeight = this.editor.getLayoutInfo().horizontalScrollbarHeight;\r\n\r\n    const editorHeight = contentHeight + horizontalScrollbarHeight;\r\n    if (this.minHeight >= 0) {\r\n      const minHeight = lineHeight * this.minHeight + horizontalScrollbarHeight;\r\n      if (editorHeight < minHeight) {\r\n        return minHeight;\r\n      }\r\n    }\r\n    if (this.maxHeight >= 0) {\r\n      const maxHeight = lineHeight * this.maxHeight + horizontalScrollbarHeight;\r\n      return Math.min(maxHeight, editorHeight);\r\n    }\r\n    return editorHeight;\r\n  }\r\n\r\n  protected toDeltaDecorations(params: DeltaDecorationParams): IModelDeltaDecoration[] {\r\n    // @ts-ignore\r\n    return params.newDecorations.map(decoration => <IModelDeltaDecoration>{\r\n      ...decoration,\r\n      range: this.p2m.asRange(decoration.range),\r\n    });\r\n  }\r\n\r\n  protected toEditorDecoration(decoration: monaco.editor.IModelDecoration): EditorDecoration & Readonly<{ id: string }> {\r\n    const range = this.m2p.asRange(decoration.range);\r\n    const {id, options} = decoration;\r\n    // @ts-ignore\r\n    return {\r\n      options,\r\n      range,\r\n      id\r\n    } as EditorDecoration & Readonly<{ id: string }>;\r\n  }\r\n\r\n  protected fireLanguageChanged(languageId: string): void {\r\n    this._languageAutoDetected = false;\r\n    this.onLanguageChangedEmitter.fire(languageId);\r\n  }\r\n\r\n}\r\n\r\nexport namespace MonacoEditor {\r\n  export interface ICommonOptions {\r\n    /**\r\n     * Whether an editor should be auto resized on a content change.\r\n     *\r\n     * #### Fixme\r\n     * remove when https://github.com/Microsoft/monaco-editor/issues/103 is resolved\r\n     */\r\n    autoSizing?: boolean;\r\n    /**\r\n     * A minimal height of an editor in lines.\r\n     *\r\n     * #### Fixme\r\n     * remove when https://github.com/Microsoft/monaco-editor/issues/103 is resolved\r\n     */\r\n    minHeight?: number;\r\n    /**\r\n     * A maximal height of an editor in lines.\r\n     *\r\n     * #### Fixme\r\n     * remove when https://github.com/Microsoft/monaco-editor/issues/103 is resolved\r\n     */\r\n    maxHeight?: number;\r\n  }\r\n\r\n  export interface IOptions extends ICommonOptions, IStandaloneEditorConstructionOptions {\r\n  }\r\n\r\n  export function getAll(manager: EditorManager): MonacoEditor[] {\r\n    return manager.all.map(e => get(e)).filter(e => !!e) as MonacoEditor[];\r\n  }\r\n\r\n  export function getCurrent(manager: EditorManager): MonacoEditor | undefined {\r\n    return get(manager.currentEditor);\r\n  }\r\n\r\n  export function getActive(manager: EditorManager): MonacoEditor | undefined {\r\n    return get(manager.activeEditor);\r\n  }\r\n\r\n  export function get(editorWidget: EditorWidget | undefined): MonacoEditor | undefined {\r\n    if (editorWidget && editorWidget.editor instanceof MonacoEditor) {\r\n      return editorWidget.editor;\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n  export function findByDocument(manager: EditorManager, document: MonacoEditorModel): MonacoEditor[] {\r\n    return getAll(manager).filter(editor => editor.documents.has(document));\r\n  }\r\n\r\n  export function getWidgetFor(manager: EditorManager, control: monaco.editor.ICodeEditor | undefined): EditorWidget | undefined {\r\n    if (!control) {\r\n      return undefined;\r\n    }\r\n    return manager.all.find(widget => {\r\n      const editor = get(widget);\r\n      return !!editor && editor.getControl() === control;\r\n    });\r\n  }\r\n}\r\n"]}