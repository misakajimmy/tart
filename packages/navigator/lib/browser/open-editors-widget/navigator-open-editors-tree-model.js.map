{"version":3,"sources":["browser/open-editors-widget/navigator-open-editors-tree-model.ts"],"names":[],"mappings":"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","file":"../../../src/browser/open-editors-widget/navigator-open-editors-tree-model.js","sourcesContent":["import {inject, injectable, postConstruct} from 'inversify';\r\nimport {debounce} from 'lodash';\r\nimport {\r\n  ApplicationShell,\r\n  CompositeTreeNode,\r\n  ExpandableTreeNode,\r\n  NavigatableWidget,\r\n  SelectableTreeNode,\r\n  TabBar,\r\n  Widget\r\n} from '@tart/core';\r\nimport {FileStatNode, FileTreeModel} from '@tart/filesystem';\r\nimport {FileStat} from '@tart/filesystem/lib/common/files';\r\nimport {DisposableCollection} from '@tart/core/lib/common';\r\n\r\nexport interface OpenEditorNode extends FileStatNode {\r\n  widget: Widget;\r\n}\r\n\r\n@injectable()\r\nexport class OpenEditorsModel extends FileTreeModel {\r\n  static GROUP_NODE_ID_PREFIX = 'group-node';\r\n  static AREA_NODE_ID_PREFIX = 'area-node';\r\n\r\n  @inject(ApplicationShell) protected readonly applicationShell: ApplicationShell;\r\n\r\n  protected toDisposeOnPreviewWidgetReplaced = new DisposableCollection();\r\n  // Returns the collection of editors belonging to a tabbar group in the main area\r\n  protected _editorWidgetsByGroup = new Map<number, { widgets: NavigatableWidget[], tabbar: TabBar<Widget> }>();\r\n\r\n  // Returns the collection of editors belonging to an area grouping (main, left, right bottom)\r\n  protected _editorWidgetsByArea = new Map<ApplicationShell.Area, NavigatableWidget[]>();\r\n\r\n  // Last collection of editors before a layout modification, used to detect changes in widget ordering\r\n  protected _lastEditorWidgetsByArea = new Map<ApplicationShell.Area, NavigatableWidget[]>();\r\n\r\n  protected cachedFileStats = new Map<string, FileStat>();\r\n  protected updateOpenWidgets = debounce(this.doUpdateOpenWidgets, 250);\r\n\r\n  get editorWidgets(): NavigatableWidget[] {\r\n    const editorWidgets: NavigatableWidget[] = [];\r\n    this._editorWidgetsByArea.forEach(widgets => editorWidgets.push(...widgets));\r\n    return editorWidgets;\r\n  }\r\n\r\n  getTabBarForGroup(id: number): TabBar<Widget> | undefined {\r\n    return this._editorWidgetsByGroup.get(id)?.tabbar;\r\n  }\r\n\r\n  @postConstruct()\r\n  protected init(): void {\r\n    super.init();\r\n    this.setupHandlers();\r\n    this.initializeRoot();\r\n  }\r\n\r\n  protected setupHandlers(): void {\r\n    this.toDispose.push(this.applicationShell.onDidChangeCurrentWidget(({newValue}) => {\r\n      const nodeToSelect = this.tree.getNode(newValue?.id);\r\n      if (nodeToSelect && SelectableTreeNode.is(nodeToSelect)) {\r\n        this.selectNode(nodeToSelect);\r\n      }\r\n    }));\r\n    this.toDispose.push(this.applicationShell.onDidAddWidget(async () => {\r\n      await this.updateOpenWidgets();\r\n      const existingWidgetIds = new Set(this.editorWidgets.map(widget => widget.id));\r\n      this.cachedFileStats.forEach((_fileStat, id) => {\r\n        if (!existingWidgetIds.has(id)) {\r\n          this.cachedFileStats.delete(id);\r\n        }\r\n      });\r\n    }));\r\n    this.toDispose.push(this.applicationShell.onDidRemoveWidget(() => this.updateOpenWidgets()));\r\n    // Check for tabs rearranged in main and bottom\r\n    this.applicationShell.mainPanel.layoutModified.connect(() => this.doUpdateOpenWidgets('main'));\r\n    this.applicationShell.bottomPanel.layoutModified.connect(() => this.doUpdateOpenWidgets('bottom'));\r\n  }\r\n\r\n  protected async initializeRoot(): Promise<void> {\r\n    await this.updateOpenWidgets();\r\n    this.fireChanged();\r\n  }\r\n\r\n  protected async doUpdateOpenWidgets(layoutModifiedArea?: ApplicationShell.Area): Promise<void> {\r\n    this._lastEditorWidgetsByArea = this._editorWidgetsByArea;\r\n    this._editorWidgetsByArea = new Map<ApplicationShell.Area, NavigatableWidget[]>();\r\n    let doRebuild = true;\r\n    const areas: ApplicationShell.Area[] = ['main', 'bottom', 'left', 'right', 'top'];\r\n    areas.forEach(area => {\r\n      const editorWidgetsForArea = this.applicationShell.getWidgets(area).filter((widget): widget is NavigatableWidget => NavigatableWidget.is(widget));\r\n      if (editorWidgetsForArea.length) {\r\n        this._editorWidgetsByArea.set(area, editorWidgetsForArea);\r\n      }\r\n    });\r\n    if (this._lastEditorWidgetsByArea.size === 0) {\r\n      this._lastEditorWidgetsByArea = this._editorWidgetsByArea;\r\n    }\r\n    // `layoutModified` can be triggered when tabs are clicked, even if they are not rearranged.\r\n    // This will check for those instances and prevent a rebuild if it is unnecessary. Rebuilding\r\n    // the tree if there is no change can cause the tree's selection to flicker.\r\n    if (layoutModifiedArea) {\r\n      doRebuild = this.shouldRebuildTreeOnLayoutModified(layoutModifiedArea);\r\n    }\r\n    if (doRebuild) {\r\n      this.root = await this.buildRootFromOpenedWidgets(this._editorWidgetsByArea);\r\n    }\r\n  }\r\n\r\n  protected shouldRebuildTreeOnLayoutModified(area: ApplicationShell.Area): boolean {\r\n    const currentOrdering = this._editorWidgetsByArea.get(area);\r\n    const previousOrdering = this._lastEditorWidgetsByArea.get(area);\r\n    if (currentOrdering?.length === 1) {\r\n      return true;\r\n    }\r\n    if (currentOrdering?.length !== previousOrdering?.length) {\r\n      return true;\r\n    }\r\n    if (!!currentOrdering && !!previousOrdering) {\r\n      return !currentOrdering.every((widget, index) => widget === previousOrdering[index]);\r\n    }\r\n    return true;\r\n  }\r\n\r\n\r\n  protected tryCreateWidgetGroupMap(): Map<Widget, CompositeTreeNode> {\r\n    const mainTabBars = this.applicationShell.mainAreaTabBars;\r\n    this._editorWidgetsByGroup = new Map();\r\n    const widgetGroupMap = new Map<Widget, CompositeTreeNode>();\r\n    if (mainTabBars.length > 1) {\r\n      mainTabBars.forEach((tabbar, index) => {\r\n        const groupNumber = index + 1;\r\n        const newCaption = `GROUP ${groupNumber}`;\r\n        const groupNode = {\r\n          parent: undefined,\r\n          id: `${OpenEditorsModel.GROUP_NODE_ID_PREFIX}:${groupNumber}`,\r\n          name: newCaption,\r\n          children: []\r\n        };\r\n        const widgets: NavigatableWidget[] = [];\r\n        tabbar.titles.map(title => {\r\n          const {owner} = title;\r\n          widgetGroupMap.set(owner, groupNode);\r\n          if (NavigatableWidget.is(owner)) {\r\n            widgets.push(owner);\r\n          }\r\n        });\r\n        this._editorWidgetsByGroup.set(groupNumber, {widgets, tabbar});\r\n      });\r\n    }\r\n    return widgetGroupMap;\r\n  }\r\n\r\n  protected async buildRootFromOpenedWidgets(widgetsByArea: Map<ApplicationShell.Area, NavigatableWidget[]>): Promise<CompositeTreeNode> {\r\n    const rootNode: CompositeTreeNode = {\r\n      id: 'open-editors:root',\r\n      parent: undefined,\r\n      visible: false,\r\n      children: [],\r\n    };\r\n\r\n    const mainAreaWidgetGroups = this.tryCreateWidgetGroupMap();\r\n\r\n    for (const [area, widgetsInArea] of widgetsByArea.entries()) {\r\n      const areaNode: CompositeTreeNode & ExpandableTreeNode = {\r\n        id: `${OpenEditorsModel.AREA_NODE_ID_PREFIX}:${area}`,\r\n        parent: rootNode,\r\n        name: area,\r\n        expanded: true,\r\n        children: []\r\n      };\r\n      for (const widget of widgetsInArea) {\r\n        const uri = widget.getResourceUri();\r\n        if (uri) {\r\n          let fileStat: FileStat;\r\n          try {\r\n            fileStat = await this.fileService.resolve(uri);\r\n            this.cachedFileStats.set(widget.id, fileStat);\r\n          } catch {\r\n            const cachedStat = this.cachedFileStats.get(widget.id);\r\n            if (cachedStat) {\r\n              fileStat = cachedStat;\r\n            } else {\r\n              continue;\r\n            }\r\n          }\r\n\r\n          const openEditorNode: OpenEditorNode = {\r\n            id: widget.id,\r\n            fileStat,\r\n            uri,\r\n            selected: false,\r\n            parent: undefined,\r\n            name: widget.title.label,\r\n            icon: widget.title.iconClass,\r\n            widget\r\n          };\r\n          // only show groupings for main area widgets if more than one tabbar\r\n          if ((area === 'main') && (mainAreaWidgetGroups.size > 1)) {\r\n            const groupNode = mainAreaWidgetGroups.get(widget);\r\n            if (groupNode) {\r\n              CompositeTreeNode.addChild(groupNode, openEditorNode);\r\n              CompositeTreeNode.addChild(areaNode, groupNode);\r\n            }\r\n          } else {\r\n            CompositeTreeNode.addChild(areaNode, openEditorNode);\r\n          }\r\n        }\r\n      }\r\n      // If widgets are only in the main area and in a single tabbar, then don't show area node\r\n      if (widgetsByArea.size === 1 && widgetsByArea.has('main') && area === 'main') {\r\n        areaNode.children.forEach(child => CompositeTreeNode.addChild(rootNode, child));\r\n      } else {\r\n        CompositeTreeNode.addChild(rootNode, areaNode);\r\n      }\r\n\r\n    }\r\n    return rootNode;\r\n  }\r\n\r\n}\r\n"]}